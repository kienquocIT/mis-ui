{% extends 'base.html' %}
{% load static i18n %}
{% block title %}{% trans 'Budget report' %}{% endblock %}
{% block cssHeader %}
    <link href="{% static 'vendors/daterangepicker/daterangepicker.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'vendors/select2/dist/css/select2.min.css' %}" rel="stylesheet" type="text/css">
{% endblock %}
{% block pageAction %}{% endblock %}
{% block pageContent %}
    {{ data.data.current_period | json_script:"current_period" }}

    <script id="trans-script"
            data-trans-all-group="{% trans 'All group (Company)' %}"
            data-trans-total-in-plan="{% trans 'Total in plan' %}"
            data-trans-total-out-plan="{% trans 'Total out plan' %}"
    ></script>

    <script id="url-script"
            data-url-budget-report-company-list="{% url 'BudgetReportCompanyListAPI' %}"
            data-url-budget-report-group-list="{% url 'BudgetReportGroupListAPI' %}"
            data-url-payment-list="{% url 'PaymentListForBudgetReportAPI' %}"
    ></script>

    <button id="btn-filter" class="btn btn-sm border-secondary bg-secondary-light-5 text-secondary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasFilter">
        <i class="fas fa-sliders-h"></i>&nbsp;{% trans 'Filter' %}
    </button>
    <div class="offcanvas offcanvas-end" style="min-width: 30vw; max-width: 75vw" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasFilter">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasScrollingLabel">{% trans 'Filter' %}</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            {% include 'extends/periods_group.html' with period_req=True quarter_active=True month_req=True date_req=False %}
            <div class="row">
                <div class="col-12 col-lg-12 col-md-12">
                    <div class="form-group">
                        <label for="group-select" class="form-label required">{% trans 'Department' %}</label>
                        <select class="form-select select2" id="group-select" data-method="GET" data-url="{% url 'BudgetPlanConfigListAPI' %}"></select>
                        <span class="small text-danger">{% trans "By granted permission in 'Budget plan config'" %}</span>
                    </div>
                </div>
                <div class="col-12 col-lg-12 col-md-12">
                    <div class="form-group">
                        <label for="view-mode-select" class="form-label">{% trans 'View mode' %}</label>
                        <select class="form-select select2" id="view-mode-select">
                            <option value="0" selected>{% trans 'Periodic result' %}</option>
                            <option value="1">{% trans 'Cumulative result' %}</option>
                        </select>
                    </div>
                </div>
                <div class="col-12 col-lg-12 col-md-12 mt-3">
                    <button type="button" class="btn btn-social btn-social-facebook btn-sm rounded w-100" id="btn-view">
                        {% trans 'Apply' %}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <table id="main-table" class="w-100 table-hover table nowrap">
                <thead class="bg-primary">
                <tr>
                    <th style="min-width: 50px; border-top-left-radius: calc(0.5rem - 1px);"></th>
                    <th class="text-white" style="min-width: 300px">{% trans 'Expense item' %}</th>
                    <th class="text-white" style="min-width: 200px">
                        {% trans 'Plan' %}
                        <i class="fas fa-info-circle icon-info"
                           data-bs-toggle="tooltip"
                           data-bs-placement="bottom"
                           title=""
                           data-bs-original-title="{% trans 'Red lines are the expenses out of plan.' %}">
                        </i>
                    </th>
                    <th class="text-white" style="min-width: 200px">{% trans 'Actual' %}</th>
                    <th class="text-white" style="min-width: 200px">{% trans 'Difference' %}</th>
                    <th class="text-white" style="min-width: 150px; border-top-right-radius: calc(0.5rem - 1px);">{% trans 'Rate' %}</th>
                </tr>
                </thead>
                <tbody></tbody>
                <tfoot></tfoot>
            </table>
        </div>
    </div>
{% endblock %}
{% block jsFooter %}
    <script src="{% static 'vendors/moment/min/moment.min.js' %}"></script>
    <script src="{% static 'vendors/daterangepicker/daterangepicker.js' %}"></script>
    <script src="{% static 'vendors/select2/dist/js/select2.full.min.js' %}"></script>
    <script src="{% static 'vendors/select2/dist/js/init-select2.js' %}"></script>

    {#    phải để theo thứ tự này để load dữ liệu báo cáo mặc định#}
    <script src="{% static 'assets/js/periods_group.js' %}"></script>
    <script src="{% static 'assets/sales/budget_report/js/budget_report.js' %}"></script>
{% endblock %}
