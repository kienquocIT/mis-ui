{% load i18n string_utils %}
<span
        id="idBlockRangeMasterElement"
        class="hidden"
        data-msg-least-one="{% trans 'Allow at least one permit' %}"
        data-msg-select-range="{% trans 'Range for permit is required' %}"
        data-msg-merge-range-empty="{% trans 'The combined range of the selected permissions has no matches' %}"
        data-msg-need-drop="{% trans 'Need drop this row when allow at least one permit' %}"
        data-msg-are-u-sure="{% trans 'Are you sure?' %}"
        data-msg-not-revert="{% trans "You won't be able to revert this!" %}"
        data-msg-yes-delete-it="{% trans 'Yes, delete it!' %}"
        data-msg-cancel="{% trans 'Cancel' %}"
        data-msg-delete="{% trans 'Delete' %}"
        data-msg-depend-app="{% trans 'Some app depend is open' %}"
        data-msg-depend-app-show="{% trans 'Depend on apps' %}"
        data-msg-same-range-of-main="{% trans 'Same range of main' %}"
        data-msg-incorrect-line="{% trans 'Some data is incorrect at line' %}"
        data-msg-check-app-depend-on-info="{% trans 'Please check/selected depends on apps at Packages - Applications then try again' %}"
></span>
{#<button class="btn btn-danger" type="button" onclick="new HandlePermissions().combinesData()">Click</button>#}
{#{% if add_new_enabled == "true" %}#}
{#    <p>#}
{#        <small class="text-danger">** {% trans 'Order will be arranged and grouped by app when updated' %}</small>#}
{#    </p>#}
{#{% endif %}#}
<script class="hidden" type="application/json" id="tblPermissionInitData"></script>
<script class="hidden" type="application/json" id="tblPermissionInitDataByKey"></script>
<div class="table-responsive">
    <table
            id="permissions_list" class="table nowrap w-100"
            data-change-enable="{% if add_new_enabled == "true" %}true{% else %}false{% endif %}"
    >
        <thead>
        <tr>
            <th>#</th>
            <th>{% trans 'Application' %}</th>
            <th>{% trans 'All' %}</th>
            <th id="headingPermitCreate">{% trans 'Create' %}</th>
            <th id="headingPermitView">{% trans 'View' %}</th>
            <th id="headingPermitEdit">{% trans 'Edit' %}</th>
            <th id="headingPermitDelete">{% trans 'Delete' %}</th>
            <th>{% trans 'Jurisdiction' %}</th>
            <th>
                <div class="d-flex align-items-center justify-content-end">
                    <span class="mr-1">{% trans 'Actions' %}</span>
                    <span class="icon mr-1">
                    <i class="fa-regular fa-square-caret-left" id="btnCollapseSubAll" style="cursor: pointer;"></i>
                </span>
                </div>
            </th>
        </tr>
        </thead>
        <tbody></tbody>
        {% if add_new_enabled == "true" %}
            <tfoot>
            <tr class="bg-green-light-5" id="row_for_setup_new">
                <td>
                    <i
                            class="fa-solid fa-circle-info text-info"
                            data-bs-toggle="tooltip" data-bs-placement="right"
                            title="{% trans 'Setup permission pre-commitment' %}"
                    ></i>
                </td>
                <td>
                    <label for="newRowApp" class="hidden"></label>
                    <select class="form-control" id="newRowApp"></select>
                </td>
                <td>
                    <div class="form-check form-switch">
                        <label for="newRowAllCheck" class="hidden"></label>
                        <input
                                type="checkbox" class="form-check-input row-e-all-foot" name="all-1"
                                id="newRowAllCheck"
                        >
                    </div>
                </td>
                <td>
                    <div class="form-check form-switch">
                        <label for="newRowCreateCheck" class="hidden"></label>
                        <input
                                type="checkbox" class="form-check-input row-e-child-foot row-e-child-create"
                                name="all-1"
                                id="newRowCreateCheck"
                        >
                    </div>
                </td>
                <td>
                    <div class="form-check form-switch">
                        <label for="newRowViewCheck" class="hidden"></label>
                        <input
                                type="checkbox" class="form-check-input row-e-child-foot row-e-child-view" name="all-1"
                                id="newRowViewCheck"
                        >
                    </div>
                </td>
                <td>
                    <div class="form-check form-switch">
                        <label for="newRowEditCheck" class="hidden"></label>
                        <input
                                type="checkbox" class="form-check-input row-e-child-foot row-e-child-edit" name="all-1"
                                id="newRowEditCheck"
                        >
                    </div>
                </td>
                <td>
                    <div class="form-check form-switch">
                        <label for="newRowDeleteCheck" class="hidden"></label>
                        <input
                                type="checkbox" class="form-check-input row-e-child-foot row-e-child-delete"
                                name="all-1"
                                id="newRowDeleteCheck"
                        >
                    </div>
                </td>
                <td>
                    <label for="newRowRange" class="hidden"></label>
                    <select class="form-control" id="newRowRange" name="permission-range">
                        {# For general #}
                        {% if range_allowed|val_in_arr:"1" == '1' %}
                            <option value="1">{% trans "Themselves" %}</option>
                        {% endif %}
                        {% if range_allowed|val_in_arr:"2" == '1' %}
                            <option value="2">{% trans "Their staff" %}</option>
                        {% endif %}
                        {% if range_allowed|val_in_arr:"3" == '1' %}
                            <option value="3">{% trans "Member in their group" %}</option>
                        {% endif %}
                        {% if range_allowed|val_in_arr:"4" == '1' %}
                            <option value="4">{% trans "All users" %}</option>
                        {% endif %}

                        {# For Opp|Prj #}
                        {% if range_allowed|val_in_arr:"5" == '1' %}
                            <option value="1">{% trans "Themselves" %}</option>
                        {% endif %}
                        {% if range_allowed|val_in_arr:"6" == '1' %}
                            <option value="4">{% trans "All" %}</option>
                        {% endif %}
                    </select>
                </td>
                <td>
                    <div class="d-flex align-items-center justify-content-end">
                        <button
                                class="btn btn-primary" type="button" id="btnAddNewRowPerms"
                        >{% trans 'Add' %}</button>
                    </div>
                </td>
            </tr>
            <tr class="hidden">
                <td colspan="9" id="sub_for_setup_new" class="wrap-text">

                </td>
            </tr>
            {#        <tr class="bg-sky-light-5">#}
            {#            <td class="wrap-text" colspan="1">#}
            {#                <i#}
            {#                        class="fa-solid fa-bolt text-warning"#}
            {#                        data-bs-toggle="tooltip" data-bs-placement="right"#}
            {#                        title="{% trans 'Quick Setup' %}"#}
            {#                ></i>#}
            {#            </td>#}
            {#            <td colspan="8">#}
            {#                <button class="btn btn-primary mr-1" type="button">Normal</button>#}
            {#                <button class="btn btn-primary mr-1" type="button">Administrator</button>#}
            {#                <button class="btn btn-primary mr-1" type="button">HR Manager</button>#}
            {#                <button class="btn btn-primary mr-1" type="button">Warehouse Manager</button>#}
            {#                <button class="btn btn-primary mr-1" type="button">Picker</button>#}
            {#                <button class="btn btn-primary mr-1" type="button">Deliver</button>#}
            {#            </td>#}
            {#        </tr>#}
            </tfoot>
        {% else %}
            <div class="hidden">
                <label for="newRowRange" class="hidden"></label>
                <select class="form-control" id="newRowRange">
                    {% if range_allowed|val_in_arr:"1" == True %}
                        <option value="1">{% trans "Themselves" %}</option>
                    {% endif %}
                    {% if range_allowed|val_in_arr:"2" == True %}
                        <option value="2">{% trans "Their staff" %}</option>
                    {% endif %}
                    {% if range_allowed|val_in_arr:"3" == True %}
                        <option value="3">{% trans "Member in their group" %}</option>
                    {% endif %}
                    {% if range_allowed|val_in_arr:"4" == True %}
                        <option value="4">{% trans "All users" %}</option>
                    {% endif %}
                </select>
            </div>
        {% endif %}
    </table>
</div>