{% extends 'base.html' %}
{% load static i18n %}
{% block cssHeader %}
    <link href="{% static 'vendors/datatables.net-rowgroup/css/dataTables.rowGroup.min.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'vendors/daterangepicker/daterangepicker.css' %}" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="{% static 'assets/css/core/hr/employee/employee_update.css' %}">
    <style>
        .row-error-disabled {
            position: relative;
        }

        .row-error-disabled::after {
            content: "{% trans 'This application has been disabled for you or cannot be found!' %}";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 14px;
            color: #fff;
        }
        .dataTables_scrollBody tr.group-header > td {
            position: sticky;
            top: 0;
            z-index: 10;
            background: rgb(235, 245, 245);
        }
        .dataTables_scrollFootInner, .dataTables_scrollFootInner table {
            width: 100% !important;
        }
    </style>
{% endblock %}
{% block pageAction %}
    <button class="btn btn-outline-primary" type="submit" form="frm_employee_update" id="update-emp">
        <span>
            <span>{% trans 'Save' %}</span>
            <span class="icon">
                <i class="fa-regular fa-floppy-disk"></i>
            </span>
        </span>
    </button>
{% endblock %}
{% block pageContent %}
    <form id="frm_employee_update" class="needs-validation" data-url="{% url 'EmployeeDetailAPI' pk=pk %}"
          data-method="PUT"
          data-url-redirect="{% url 'EmployeeList' %}"
          novalidate
          data-doc-id="{{ data.data.doc_id }}"
    >
        {% csrf_token %}
        <div id="employee-detail-page" class="needs-validation"
             data-url="{% url 'EmployeeDetailAPI' pk=pk %}"
             data-method="GET"
             data-url-redirect="{% url 'EmployeeList' %}"
             data-doc-id="{{ data.data.doc_id }}"
        >
            {% csrf_token %}
            {% include 'core/hr/extends_new/permission_group_tabs_has_change_app.html' with range_allowed="1,2,3,4" get_from='employee' actions_enabled=True plan_app_enabled=True permit_enabled=True li_head='core/hr/employee/extends/tab-info.html' li_content_head='core/hr/employee/extends/tab-info-content.html' li_content_head_disabled=False %}
        </div>
    </form>
{% endblock %}
{% block modalData %}
{#    <div class="modal fade" id="update-email-api-key-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenter" aria-hidden="true">#}
{#        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">#}
{#            <div class="modal-content">#}
{#                <div class="modal-header">#}
{#                    <h5 class="modal-title">{% trans 'Email verify' %}</h5>#}
{#                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">#}
{#                        <span aria-hidden="true">&times;</span>#}
{#                    </button>#}
{#                </div>#}
{#                <div class="modal-body">#}
{#                    <form id="form-update-email-api-key"#}
{#                          data-trans-update-success="{% trans 'Connect successfully. Updating API Key...' %}"#}
{#                          data-trans-update-fail="{% trans 'Can not verify your Email. Check your API Key again' %}"#}
{#                          data-url="{% url 'EmployeeUpdateEmailAPIKeyAPI' '0' %}"#}
{#                          data-method="PUT">#}
{#                        {% csrf_token %}#}
{#                        <div class="row">#}
{#                            <div class="col-12">#}
{#                                <div class="form-group">#}
{#                                    <div class="row">#}
{#                                        <div class="col-8">#}
{#                                            <label class="form-label" for="email-app-password">#}
{#                                                {% trans 'Google API Key' %}#}
{#                                            </label>#}
{#                                        </div>#}
{#                                        <div class="col-4 text-right small fw-bold">#}
{#                                            <a href="https://myaccount.google.com/apppasswords" target="_blank">{% trans 'Get here' %}</a>#}
{#                                        </div>#}
{#                                    </div>#}
{#                                    <input type="password" class="form-control" id="email-app-password" placeholder="{% trans '19 letters' %} ({% trans 'include space' %})">#}
{#                                    <label class="text-muted fst-italic small">{% trans 'Your Google account must be TURNED ON 2-Step verification first.' %}</label>#}
{#                                </div>#}
{#                            </div>#}
{#                        </div>#}
{#                    </form>#}
{#                </div>#}
{#                <div class="modal-footer">#}
{#                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans 'Close' %}</button>#}
{#                    <button id="btn-test-email-connection"#}
{#                            data-url="{% url 'TestEmailConnection' %}"#}
{#                            type="button"#}
{#                            class="btn btn-primary"#}
{#                    >{% trans 'Test connection and Save' %}</button>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#    </div>#}
{% endblock %}
{% block jsFooter %}
    <script>
        function onLoadDropdownUserDetail(eleInfo, eleInfoData, selectedData) {
            let userData = selectedData?.['user'] || {};
            if (typeof userData === 'object' && Object.keys(userData).length > 0){
                eleInfoData.find('.user-info-detail-first-name').val(userData['first_name'] || '');
                eleInfoData.find('.user-info-detail-last-name').val(userData['last_name'] || '');
                eleInfoData.find('.user-info-detail-email').val(userData['email'] || '');
            }
            return eleInfo;
        }
    </script>
    <script src="{% static 'vendors/datatables.net-rowgroup/js/dataTables.rowGroup.min.js' %}"></script>
    <script src="{% static 'vendors/daterangepicker/daterangepicker.js' %}"></script>
    <script src="{% static 'assets/js/core/hr/employee/employee_pk.js' %}"></script>
    <script src="{% static 'assets/js/core/hr/employee/employee_update.js' %}"></script>
    <script src="{% static 'assets/js/core/hr/extends_new/plan_app_permissions.js' %}"></script>
{% endblock %}