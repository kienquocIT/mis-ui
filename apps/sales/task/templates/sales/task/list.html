{% extends 'base.html' %}
{% load static i18n %}
{% block title %}{% trans 'Task list page' %}{% endblock %}
{% block cssHeader %}
    <link href="{% static 'vendors/dragula/dragula.min.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'assets/css/perfect-scrollbar.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'vendors/daterangepicker/daterangepicker.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'vendors/select2/dist/css/select2.min.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'assets/sales/task/css/task.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'assets/sales/task/css/create-form.css' %}" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block pageAction %}
    <a href="#">
        <button class="btn btn-outline-primary ntt-drawer-toggle-link btn-create-todo"
                type="button"
                data-drawer-target="#drawer_task_create"
                data-drawer-active="false"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                data-bs-original-title="{% trans 'Create' %}">
        <span>
            <span>{% trans 'Create' %}</span>
            <span class="icon">
                <i class="fa-solid fa-plus"></i>
            </span>
        </span>
        </button>
    </a>
{% endblock %}

{% block pageContent %}
    <!-- Navigation task list/kanban-->
    <ul class="nav nav-line nav-light nav-tabs">
        <li class="nav-item">
            <a class="nav-link active" data-bs-toggle="tab" href="#tab_block_1">
                <i class="fa-solid fa-table-columns"></i>
                <span class="nav-link-text">{% trans 'Kanban' %}</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-bs-toggle="tab" href="#tab_block_2">
                <i class="fa-solid fa-list-ul"></i>
                <span class="nav-link-text">{% trans 'List' %}</span>
            </a>
        </li>
    </ul>
    <!-- task kanban -->
    <div class="tab-content">
        <div class="tab-pane fade show active" id="tab_block_1">
            <div id="kb_scroll" class="tasklist-scroll position-relative">
                <div id="tasklist_wrap" class="tasklist-wrap">
                </div>
            </div>
            <div id="kb_sub_scroll" class="sub-tasklist-scroll position-relative">
                <div id="sub-tasklist_wrap" class="sub-tasklist-wrap w-">
                </div>
            </div>

        </div>
        <div class="tab-pane fade" id="tab_block_2">
            <div class="list_task_wrap">
                <table id="table_task_list" class="table nowrap table-advance w-100">
                </table>
            </div>
        </div>
    </div>

    <div class="hidden">
        <div class="card-parent_template">
            <div class="card card-simple card-border tasklist">
                <div class="card-header card-header-action">
                    <div class="tasklist-handle">
                        <h6 class="text-uppercase fw-bold d-flex align-items-center mb-0">
                            <span class="tasklist-name"></span><span
                                class="task-count"></span></h6>
                        <div class="card-action-wrap">
                            <button class="btn btn-flush-primary btn-animated btn-add-newtask">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div id="" class="wrap-child">
                    </div>
                </div>
            </div>
        </div>
        <div class="card-child_template">
            <div class="card card-border card-simple tasklist-card">
                <div class="card-header card-header-action">
                    <h6 class="fw-bold card-code"></h6>
                    <div class="card-action-wrap">
                        <a class="btn btn-flush-dark flush-soft-hover dropdown-toggle no-caret"
                           href="#" data-bs-toggle="dropdown">
                            <span class="icon">
                                <i class="fa-solid fa-ellipsis-vertical"></i>
                            </span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end">
                            <a class="dropdown-item del-task-act" href="#"><span>{% trans 'Delete' %}</span></a>
                            <a class="dropdown-item log-task-act" href="#logWorkModal">
                                <span>{% trans 'Log time' %}</span></a>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="mb-2 d-flex">
                        <div class="card-priority d-inline-block mr-2"></div>
                        <a href="#" class="card-title" title></a>
                    </div>
                    <div class="avatar avatar-rounded avatar-xs" data-toggle="tooltip" title="">
                        <span class="initial-wrap">
                            <img src="" alt="user"
                             class="avatar-img">
                        </span>
                    </div>
                </div>
                <div class="card-footer text-muted justify-content-between">
                    <div>
                        <span class="task-counter">
                            <i class="fa-regular fa-square-check"></i>&nbsp;
                            <span class="checklist_progress">0/0</span>
                        </span>
                        <span class="task-discuss">
                            {% trans 'Sub' %}&nbsp;
                            <span class="sub_task_count circle bg-blue text-white">0</span>
                        </span>
                    </div>
                    <div>
                        <span class="task-deadline">22 Sep, 22</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="priority-badges">
            <div class="badge-icon badge-icon-xxs">
                <div class="badge-icon-wrap"></div>
                <svg xmlns="http://www.w3.org/2000/svg" class="polygon" viewBox="0 0 127 139.4">
                    <g data-name="Polygon 7" transform="translate(119 5.675)rotate(90)" fill="currentColor">
                        <path d="M87.3 115L40.7 115C37.3 115 34 114.1 31.2 112.5 28.3 110.8 25.9 108.4 24.2 105.5L0.9 65C-0.8 62.1-1.7 58.8-1.7 55.5 -1.7 52.2-0.8 48.9 0.9 46L24.2 5.5C25.9 2.6 28.3 0.2 31.2-1.5 34-3.1 37.3-4 40.7-4L87.3-4C90.7-4 94-3.1 96.8-1.5 99.7 0.2 102.1 2.6 103.8 5.5L127.1 46C128.8 48.9 129.7 52.2 129.7 55.5 129.7 58.8 128.8 62.1 127.1 65L103.8 105.5C102.1 108.4 99.7 110.8 96.8 112.5 94 114.1 90.7 115 87.3 115Z"/>
                        <path d="M40.7 0C35.3 0 30.3 2.9 27.7 7.5L4.3 48C1.6 52.6 1.6 58.4 4.3 63L27.7 103.5C30.3 108.1 35.3 111 40.7 111L87.3 111C92.7 111 97.7 108.1 100.3 103.5L123.7 63C126.4 58.4 126.4 52.6 123.7 48L100.3 7.5C97.7 2.9 92.7 0 87.3 0L40.7 0M40.7-8L87.3-8C95.5-8 103.2-3.6 107.3 3.5L130.6 44C134.7 51.1 134.7 59.9 130.6 67L107.3 107.5C103.2 114.6 95.5 119 87.3 119L40.7 119C32.5 119 24.8 114.6 20.7 107.5L-2.6 67C-6.7 59.9-6.7 51.1-2.6 44L20.7 3.5C24.8-3.6 32.5-8 40.7-8Z"
                              fill="currentColor"/>
                    </g>
                </svg>
            </div>
        </div>
        <input type="text" id="url-factory" data-task-list="{% url 'OpportunityTaskListAPI' %}"
               data-task-detail="{% url 'OpportunityTaskDetailAPI' 1 %}"
               data-logtime="{% url 'OpportunityTaskLogTimeAPI' %}"
               data-change-stt="{% url 'OpportunityTaskStatusAPI' %}"
        />
        {{ data.task_config|json_script:'task_config' }}
    </div>
    {% include 'sales/task/extend/task-form.html' %}
{% endblock %}
{% block jsFooter %}
    <script src="{% static 'vendors/ckeditor/ckeditor.js' %}"></script>
    <script src="{% static 'vendors/moment/min/moment.min.js' %}"></script>
    <script src="{% static 'vendors/daterangepicker/daterangepicker.js' %}"></script>
    <script src="{% static 'assets/js/perfect-scrollbar.min.js' %}"></script>
    <script src="{% static 'vendors/dragula/dragula.min.js' %}"></script>
    <script src="{% static 'vendors/select2/dist/js/select2.full.min.js' %}"></script>
    <script src="{% static 'assets/sales/task/js/extend/create-task.js' %}"></script>
    <script src="{% static 'assets/sales/task/js/list.js' %}"></script>
{% endblock %}
