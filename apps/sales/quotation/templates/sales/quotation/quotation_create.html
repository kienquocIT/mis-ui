{% extends 'base.html' %}
{% load static i18n %}
{% block cssHeader %}
    <link href="{% static 'assets/sales/quotation/css/quotation_create.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'vendors/select2/dist/css/select2.min.css' %}" rel="stylesheet" type="text/css">
{% endblock %}
{% block pageAction %}
    <button class="btn btn-outline-primary" type="submit" form="frm_quotation_create">
        <span>
            <span>{% trans 'Save' %}</span>
            <span class="icon">
                <i class="fa-regular fa-floppy-disk"></i>
            </span>
        </span>
    </button>
{% endblock %}

{% block pageContent %}
    <script hidden id="direct-btn-group-url"
        data-url-list-api="{% url 'QuotationListAPI' %}"
        data-url-create="{% url 'QuotationCreate' %}"
        data-url-detail="{% url 'QuotationDetail' '0' %}"
        data-key-return="quotation_list"
    ></script>
    {{ data.data.import_db_form_cfg | json_script:"import_db_form_cfg" }}

    <div class="row">
        <div class="col-12 col-md-6 col-lg-6">
            <ul class="nav nav-line nav-tabs nav-light justify-content-start quotation-tabs">
                <li class="nav-item quotation-tab-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#tab_block_1">
                        <span class="nav-link-text">{% trans 'Quotation' %}</span>
                    </a>
                </li>
                <li class="nav-item quotation-tab-item" id="tab-indicator" data-zone="quotation_indicators_data">
                    <a class="nav-link" data-bs-toggle="tab" href="#tab_block_2">
                        <span class="nav-link-text">{% trans 'Indicator' %}</span>
                    </a>
                </li>
            </ul>
        </div>
        <div class="col-12 col-md-6 col-lg-6">
            <div class="d-flex justify-content-end">
                <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                    <span
                            id="tooltip-btn-copy" class="d-inline-block" tabindex="0" data-bs-toggle="tooltip"
                            data-bs-placement="bottom" title="{% trans 'Copy Quotation' %}"
                    >
                        <button
                                type="button" class="btn btn-outline-secondary btn-square" id="btn-copy-quotation"
                                data-bs-toggle="modal" data-bs-target="#quotationModalCenter" data-copy-type="copy-from"
                                data-zone="title"
                        ><i class="far fa-copy"></i></button>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <form
            data-url="{% url 'QuotationListAPI' %}"
            data-url-redirect="{% url 'QuotationList' %}"
            data-method="POST"
            id="frm_quotation_create"
            method="post"
    >
        {% csrf_token %}
        <div class="tab-content">
            <div class="tab-pane fade show active" id="tab_block_1">
                <div class="container-fluid">
                    {% trans 'Select Sale Person' as inherit_title %}
                    {% include 'extends/the-documents/bastion.html' with auto_select_current_employee=True priority_app='opp-process-prj-inherit' opp_title=opp_title has_opp=True has_process=True has_inherit=True is_open=True inherit_title=inherit_title inherit_required=True auto_select_current_employee=True %}
                    <div class="row">
                        <div class="col-12 col-md-6 col-lg-6">
                            <div class="form-group">
                                <label
                                        class="form-label required" for="title"
                                >{% trans 'Title' %}</label>
                                <input
                                        type="text" class="form-control"
                                        name="title"
                                        id="title"
                                        required
                                >
                            </div>
                        </div>
                        <div class="col-12 col-md-3 col-lg-3">
                            <div class="form-group">
                                <label
                                        class="form-label" for="quotation-create-date-created"
                                >{% trans 'Date Created' %}</label>
                                <input
                                        type="text" class="form-control form-control-line mt-1"
                                        id="quotation-create-date-created" readonly
                                >
                            </div>
                        </div>
                        <div class="col-12 col-md-3 col-lg-3">
                            <div class="form-check form-check-lg mt-5">
                                <input type="checkbox" class="form-check-input" id="is_customer_confirm" name="is_customer_confirm">
                                <label class="form-check-label fw-bold" for="is_customer_confirm">{% trans 'Customer Confirm' %}</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-md-6 col-lg-6">
                            <div class="form-group">
                                <label
                                        class="form-label required" for="customer_id"
                                >{% trans 'Customer' %}</label>
                                <select
                                        class="form-select"
                                        id="customer_id"
                                        data-url="{% url "AccountForSaleListAPI" %}"
                                        data-method="GET"
                                        data-link-detail="{% url "AccountDetail" 1 %}"
                                        name="customer_id"
                                        data-keyResp="account_sale_list"
                                        data-keyText="name"
                                        required
                                ></select>
                            </div>
                        </div>
                        <div class="col-12 col-md-3 col-lg-3">
                            <div class="form-group">
                                <label
                                        class="form-label required" for="contact_id"
                                >{% trans 'Contact' %}</label>
                                <select
                                        class="form-select"
                                        id="contact_id"
                                        data-url="{% url "ContactListAPI" %}"
                                        data-method="GET"
                                        data-link-detail="{% url 'ContactDetail' 1 %}"
                                        name="contact_id"
                                        data-keyResp="contact_list"
                                        required
                                ></select>
                            </div>
                        </div>
                        <div class="col-12 col-md-3 col-lg-3">
                            <div class="form-group">
                                <label
                                        class="form-label" for="payment_term_id"
                                >{% trans 'Select Payment Terms' %}</label>
                                <select
                                        class="form-select"
                                        id="payment_term_id"
                                        data-url="{% url "PaymentsTermsListAPI" %}"
                                        data-link-detail=""
                                        data-method="GET"
                                        name="payment_term_id"
                                        data-keyResp="payment_terms_list"
                                ></select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="row">
                            <ul class="nav nav-light nav-tabs" id="quotation-tabs">
                                <li class="nav-item tab-detail" data-zone="quotation_products_data">
                                    <a class="nav-link active" data-bs-toggle="tab" href="#tab_line_detail">
                                        <span class="nav-icon-wrap mr-1"><i class="fas fa-cube"></i></span>
                                        <span class="nav-link-text">{% trans 'Product' %}</span>
                                    </a>
                                </li>
                                <li class="nav-item tab-cost" data-zone="quotation_costs_data">
                                    <a class="nav-link" data-bs-toggle="tab" href="#tab_cost">
                                        <span class="nav-icon-wrap mr-1"><i class="fas fa-dollar-sign"></i></span>
                                        <span class="nav-link-text">{% trans 'Cost' %}</span>
                                    </a>
                                </li>
                                <li class="nav-item tab-expense" data-zone="quotation_expenses_data">
                                    <a class="nav-link" data-bs-toggle="tab" href="#tab_expense">
                                        <span class="nav-icon-wrap mr-1"><i class="fas fa-hand-holding-usd"></i></span>
                                        <span class="nav-link-text">{% trans 'Expense' %}</span>
                                    </a>
                                </li>
                                <li class="nav-item tab-logistic">
                                    <a class="nav-link" data-bs-toggle="tab" href="#tab_logistic">
                                        <span class="nav-icon-wrap mr-1"><i class="fas fa-truck"></i></span>
                                        <span class="nav-link-text">{% trans 'Logistics' %}</span>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        <div class="tab-content" id="tab-content-quotation-product">
                            <div class="tab-pane fade show active" id="tab_line_detail">
                                <div class="row import-db-space">
                                    {% include 'extends/import-datatable/button-import-db.html' %}
                                    <script class="import-db-form-url"
                                          data-import-db-method="POST"
                                          data-import-db-url="{% url 'ProductQuotationListLoadDBAPI'%}"
                                    ></script>
                                    <script class="import_data_rows">[]</script>
                                    <table
                                            id="datable-quotation-create-product"
                                            class="table nowrap min-w-1440p w-100 mb-5"
                                    >
                                        <thead>
                                        <tr class="bg-light">
                                            <th></th>
                                            <th>{% trans 'Product' %}</th>
                                            <th>{% trans 'Description' %}</th>
                                            <th>{% trans 'UoM' %}</th>
                                            <th>{% trans 'Quantity' %}</th>
                                            <th>{% trans 'Unit Price' %}</th>
                                            <th>{% trans 'Discount' %}</th>
                                            <th>{% trans 'Tax' %}</th>
                                            <th>{% trans 'Subtotal Price' %}</th>
                                            <th></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                        <tfoot>
                                        <tr>
                                            <th colspan="5"></th>
                                            <th colspan="5">
                                                <div class="row mb-2">
                                                    <div class="col-6">
                                                        <p style="text-align: right">{% trans 'Pretax Amount' %}:</p>
                                                    </div>
                                                    <div class="col-2"></div>
                                                    <div class="col-4">
                                                        <span
                                                                class="mask-money font-3 quotation-create-product-pretax-amount"
                                                                data-init-money="0" data-zone="quotation_products_data"
                                                        ></span>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-product-pretax-amount-raw"
                                                                value="0" hidden
                                                        >
                                                        <input
                                                                type="text" class="quotation-final-revenue-before-tax"
                                                                hidden
                                                        >
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-6">
                                                        <p style="text-align: right">{% trans 'Discount' %}:</p>
                                                    </div>
                                                    <div class="col-2">
                                                        <div class="input-group w-90">
                                                            <span class="input-affix-wrapper">
                                                                <input
                                                                        type="text"
                                                                        class="form-control validated-number quotation-create-product-discount"
                                                                        value="0" data-zone="quotation_products_data"
                                                                >
                                                                <span class="input-suffix"><small><i
                                                                        class="fas fa-percentage"
                                                                ></i></small></span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <div class="col-4">
                                                        <span
                                                                class="mask-money font-3 quotation-create-product-discount-amount"
                                                                data-init-money="0" data-zone="quotation_products_data"
                                                        ></span>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-product-discount-amount-raw"
                                                                value="0" hidden
                                                        >
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-6">
                                                        <p style="text-align: right">{% trans 'Taxes' %}:</p>
                                                    </div>
                                                    <div class="col-2"></div>
                                                    <div class="col-4">
                                                        <span
                                                                class="mask-money font-3 quotation-create-product-taxes"
                                                                data-init-money="0" data-zone="quotation_products_data"
                                                        ></span>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-product-taxes-raw"
                                                                value="0" hidden
                                                        >
                                                    </div>
                                                </div>
                                                <hr>
                                                <div class="row">
                                                    <div class="col-6">
                                                        <b><p style="text-align: right">{% trans 'Total' %}:</p></b>
                                                    </div>
                                                    <div class="col-2"></div>
                                                    <div class="col-4">
                                                        <b><span
                                                                class="mask-money font-3 quotation-create-product-total"
                                                                data-init-money="0" data-zone="quotation_products_data"
                                                        ></span></b>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-product-total-raw"
                                                                value="0" hidden
                                                        >
                                                    </div>
                                                </div>
                                            </th>
                                        </tr>
                                        </tfoot>
                                    </table>
                                </div>
                                <div class="row">
                                    <div class="col-12 col-md-6 col-lg-6">
                                        <div
                                                class="modal fade" id="shippingFeeModalCenter" tabindex="-1"
                                                role="dialog" aria-labelledby="shippingFeeModalCenter"
                                                aria-hidden="true"
                                        >
                                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">{% trans 'Shipping' %}</h5>
                                                        <button
                                                                type="button"
                                                                class="btn btn-icon btn-rounded btn-flush-light flush-soft-hover btn-lg"
                                                                data-bs-dismiss="modal"
                                                        ><span class="icon"><i class="far fa-window-close"></i></span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <table
                                                                id="datable-quotation-create-shipping"
                                                                class="table nowrap w-100 mb-5"
                                                        >
                                                            <thead>
                                                            <tr class="bg-light">
                                                                <th class="w-10"></th>
                                                                <th class="w-60">{% trans 'Title' %}</th>
                                                                <th class="w-30">{% trans 'Actions' %}</th>
                                                            </tr>
                                                            </thead>
                                                            <tbody>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button
                                                                type="button" class="btn btn-secondary"
                                                                data-bs-dismiss="modal"
                                                                data-zone="quotation_products_data"
                                                        >{% trans 'Close' %}</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                                class="modal fade" id="promotionModalCenter" tabindex="-1"
                                                role="dialog" aria-labelledby="promotionModalCenter"
                                                aria-hidden="true"
                                        >
                                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">{% trans 'Promotion' %}</h5>
                                                        <button
                                                                type="button"
                                                                class="btn btn-icon btn-rounded btn-flush-light flush-soft-hover btn-lg"
                                                                data-bs-dismiss="modal"
                                                        ><span class="icon"><i class="far fa-window-close"></i></span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <table
                                                                id="datable-quotation-create-promotion"
                                                                class="table nowrap w-100 mb-5"
                                                        >
                                                            <thead>
                                                            <tr class="bg-light">
                                                                <th class="w-10"></th>
                                                                <th class="w-60">{% trans 'Title' %}</th>
                                                                <th class="w-30">{% trans 'Actions' %}</th>
                                                            </tr>
                                                            </thead>
                                                            <tbody>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button
                                                                type="button" class="btn btn-secondary"
                                                                data-bs-dismiss="modal"
                                                                data-zone="quotation_products_data"
                                                        >{% trans 'Close' %}
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="tab_cost">
                                <div class="row">
                                    <table
                                            id="datable-quotation-create-cost"
                                            class="table nowrap min-w-1366p w-100 mb-5"
                                    >
                                        <thead>
                                        <tr class="bg-light">
                                            <th class="w-5"></th>
                                            <th class="w-20">{% trans 'Product' %}</th>
                                            <th class="w-10">{% trans 'Supplied by' %}</th>
                                            <th class="w-10">{% trans 'UOM' %}</th>
                                            <th class="w-10">{% trans 'Quantity' %}</th>
                                            <th class="w-15">{% trans 'Cost Price' %}</th>
                                            <th class="w-5">{% trans 'Tax' %}</th>
                                            <th class="w-15">{% trans 'Subtotal Price' %}</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                        <tfoot>
                                        <tr>
                                            <th colspan="5"></th>
                                            <th colspan="3">
                                                <div class="row mb-2">
                                                    <div class="col-6">
                                                        <p style="text-align: right">{% trans 'Pretax Amount' %}:</p>
                                                    </div>
                                                    <div class="col-1"></div>
                                                    <div class="col-5">
                                                        <span
                                                                class="mask-money font-3 quotation-create-cost-pretax-amount"
                                                                data-init-money="0" data-zone="quotation_costs_data"
                                                        ></span>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-cost-pretax-amount-raw"
                                                                value="0" hidden
                                                        >
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-6">
                                                        <p style="text-align: right">{% trans 'Taxes' %}:</p>
                                                    </div>
                                                    <div class="col-1"></div>
                                                    <div class="col-5">
                                                        <span
                                                                class="mask-money font-3 quotation-create-cost-taxes"
                                                                data-init-money="0" data-zone="quotation_costs_data"
                                                        ></span>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-cost-taxes-raw"
                                                                value="0" hidden
                                                        >
                                                    </div>
                                                </div>
                                                <hr>
                                                <div class="row">
                                                    <div class="col-6">
                                                        <b><p style="text-align: right">{% trans 'Total' %}:</p></b>
                                                    </div>
                                                    <div class="col-1"></div>
                                                    <div class="col-5">
                                                        <b><span
                                                                class="mask-money font-3 quotation-create-cost-total"
                                                                data-init-money="0" data-zone="quotation_costs_data"
                                                        ></span></b>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-cost-total-raw"
                                                                value="0" hidden
                                                        >
                                                    </div>
                                                </div>
                                            </th>
                                        </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="tab_expense">
                                <div class="row">
                                    <table
                                            id="datable-quotation-create-expense"
                                            class="table nowrap min-w-1440p w-100 mb-5"
                                    >
                                        <thead>
                                        <tr class="bg-light">
                                            <th></th>
                                            <th>{% trans 'Expense name' %}</th>
                                            <th>{% trans 'Expense items' %}</th>
                                            <th>{% trans 'UoM' %}</th>
                                            <th>{% trans 'Quantity' %}</th>
                                            <th>{% trans 'Expense Price' %}</th>
                                            <th>{% trans 'Tax' %}</th>
                                            <th>{% trans 'Subtotal Price' %}</th>
                                            <th></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                        <tfoot>
                                        <tr>
                                            <th colspan="5"></th>
                                            <th colspan="4">
                                                <div class="row mb-2">
                                                    <div class="col-6">
                                                        <p style="text-align: right">{% trans 'Pretax Amount' %}:</p>
                                                    </div>
                                                    <div class="col-1"></div>
                                                    <div class="col-5">
                                                        <span
                                                                class="mask-money font-3 quotation-create-expense-pretax-amount"
                                                                data-init-money="0" data-zone="quotation_expenses_data"
                                                        ></span>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-expense-pretax-amount-raw"
                                                                value="0" hidden
                                                        >
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-6">
                                                        <p style="text-align: right">{% trans 'Taxes' %}:</p>
                                                    </div>
                                                    <div class="col-1"></div>
                                                    <div class="col-5">
                                                        <span
                                                                class="mask-money font-3 quotation-create-expense-taxes"
                                                                data-init-money="0" data-zone="quotation_expenses_data"
                                                        ></span>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-expense-taxes-raw"
                                                                value="0" hidden
                                                        >
                                                    </div>
                                                </div>
                                                <hr>
                                                <div class="row">
                                                    <div class="col-6">
                                                        <b><p style="text-align: right">{% trans 'Total' %}:</p></b>
                                                    </div>
                                                    <div class="col-1"></div>
                                                    <div class="col-5">
                                                        <b><span
                                                                class="mask-money font-3 quotation-create-expense-total"
                                                                data-init-money="0" data-zone="quotation_expenses_data"
                                                        ></span></b>
                                                        <input
                                                                type="text"
                                                                class="form-control quotation-create-expense-total-raw"
                                                                value="0" hidden
                                                        >
                                                    </div>
                                                </div>
                                            </th>
                                        </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="tab_logistic">
                                <div class="row logistics-body">
                                    <div class="row">
                                        <div class="col-12 col-md-6 col-lg-6">
                                            <div class="form-group">
                                                <label class="form-label">{% trans 'Shipping Address' %}
                                                    <button
                                                            type="button"
                                                            class="btn btn-icon btn-rounded flush-soft-hover btn-sm"
                                                            data-bs-toggle="modal" data-bs-target="#shippingModalCenter"
                                                            data-zone="quotation_logistic_data"
                                                    ><span class="icon"><i
                                                            class="fa-regular fa-pen-to-square"
                                                    ></i></span></button>
                                                </label>
                                                <textarea
                                                        class="form-control text-black" rows="3" cols="50" name=""
                                                        id="quotation-create-shipping-address"
                                                        data-zone="quotation_logistic_data_readonly" disabled
                                                ></textarea>
                                                <input type="text" id="quotation-create-customer-shipping" hidden>
                                            </div>
                                            <div
                                                    class="modal fade" id="shippingModalCenter" tabindex="-1"
                                                    role="dialog" aria-labelledby="shippingModalCenter"
                                                    aria-hidden="true"
                                            >
                                                <div
                                                        class="modal-dialog modal-dialog-centered modal-lg"
                                                        role="document"
                                                >
                                                    <div
                                                            class="modal-content"
                                                            id="quotation-create-modal-shipping-body"
                                                    >
                                                        <div class="modal-header">
                                                            <h5 class="modal-title">{% trans 'Shipping Address' %}</h5>
                                                            <button
                                                                    type="button"
                                                                    class="btn btn-icon btn-rounded btn-flush-light flush-soft-hover btn-lg"
                                                                    data-bs-dismiss="modal"
                                                            ><span class="icon"><i
                                                                    class="far fa-window-close"
                                                            ></i></span></button>
                                                        </div>
                                                        <div class="modal-body"></div>
                                                        <div class="modal-footer">
                                                            <button
                                                                    type="button" class="btn btn-secondary"
                                                                    data-bs-dismiss="modal"
                                                            >{% trans 'Close' %}</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-6">
                                            <div class="form-group">
                                                <label class="form-label">{% trans 'Billing Address' %}
                                                    <button
                                                            type="button"
                                                            class="btn btn-icon btn-rounded flush-soft-hover btn-sm"
                                                            data-bs-toggle="modal" data-bs-target="#billingModalCenter"
                                                            data-zone="quotation_logistic_data"
                                                    ><span class="icon"><i
                                                            class="fa-regular fa-pen-to-square"
                                                    ></i></span></button>
                                                </label>
                                                <textarea
                                                        class="form-control text-black" rows="3" cols="50" name=""
                                                        id="quotation-create-billing-address"
                                                        data-zone="quotation_logistic_data_readonly" disabled
                                                ></textarea>
                                                <input type="text" id="quotation-create-customer-billing" hidden>
                                            </div>
                                            <div
                                                    class="modal fade" id="billingModalCenter" tabindex="-1"
                                                    role="dialog" aria-labelledby="billingModalCenter"
                                                    aria-hidden="true"
                                            >
                                                <div
                                                        class="modal-dialog modal-dialog-centered modal-lg"
                                                        role="document"
                                                >
                                                    <div class="modal-content" id="quotation-create-modal-billing-body">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title">{% trans 'Billing Address' %}</h5>
                                                            <button
                                                                    type="button"
                                                                    class="btn btn-icon btn-rounded btn-flush-light flush-soft-hover btn-lg"
                                                                    data-bs-dismiss="modal"
                                                            ><span class="icon"><i
                                                                    class="far fa-window-close"
                                                            ></i></span></button>
                                                        </div>
                                                        <div class="modal-body"></div>
                                                        <div class="modal-footer">
                                                            <button
                                                                    type="button" class="btn btn-secondary"
                                                                    data-bs-dismiss="modal"
                                                            >{% trans 'Close' %}</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button
                        type="button" class="btn btn-primary" id="btn-invalid-promotion" data-bs-toggle="modal"
                        data-bs-target="#invalidPromotionModalCenter" hidden
                >
                    Vertically centered modal
                </button>
                <div
                        class="modal fade" id="invalidPromotionModalCenter" tabindex="-1" role="dialog"
                        aria-labelledby="invalidPromotionModalCenter" aria-hidden="true"
                >
                    <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-body modal-body-invalid-promotion mb-2">
                                <h6 class="mb-3">{% trans 'Apply Promotion Fail.' %}</h6>
                                <p>{% trans 'Document is unqualified for promotion applied. Remove promotion or select another available promotion.' %}</p>
                            </div>
                            <div class="row modal-footer-invalid-promotion">
                                <div class="col-6">
                                    <button
                                            type="button" class="btn btn-link btn-remove-promotion"
                                            data-bs-dismiss="modal" id="btn-remove-promotion"
                                    >{% trans 'Remove Promotion.' %}</button>
                                </div>
                                <div class="col-6">
                                    <button
                                            type="button" class="btn btn-link btn-see-promotion" data-bs-dismiss="modal"
                                            id="btn-check-another-promotion"
                                    >{% trans 'See Promotion' %}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="tab_block_2">
                <div class="row">
                    <table
                            id="datable-quotation-create-indicator"
                            class="table nowrap w-100 mb-5"
                    >
                        <thead>
                        <tr class="bg-light">
                            <th></th>
                            <th>{% trans 'Indicator name' %}</th>
                            <th>{% trans 'Indicator value' %}</th>
                            <th>{% trans 'Indicator rate' %}</th>
                        </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <input
                        type="text"
                        id="quotation-indicator-data"
                        data-url="{% url 'QuotationIndicatorListAPI' %}"
                        data-method="get"
                        hidden
                >
            </div>
        </div>

        <div class="modal-area">
            <div
                    class="modal fade" id="quotationModalCenter" tabindex="-1"
                    role="dialog" aria-labelledby="quotationModalCenter"
                    aria-hidden="true" data-zone="title"
            >
                <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title"><b>{% trans 'Select Quotation' %}</b></h5>
                            <button
                                    type="button"
                                    class="btn btn-icon btn-rounded btn-flush-light flush-soft-hover btn-lg"
                                    data-bs-dismiss="modal"
                            ><span class="icon"><i class="far fa-window-close"></i></span></button>
                        </div>
                        <div class="modal-body">
                            <table
                                    id="datable-copy-quotation"
                                    class="table nowrap w-100 mb-5"
                            >
                                <thead>
                                <tr class="bg-light">
                                    <th class="w-30">{% trans 'Quotation' %}</th>
                                    <th class="w-30">{% trans 'Opportunity' %}</th>
                                    <th class="w-30">{% trans 'Customer' %}</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                            <div class="form-check form-check-lg" id="copy-quotation-option" hidden>
                                <input type="checkbox" class="form-check-input check-option" id="customCheck1" checked>
                                <label
                                        class="form-check-label" for="customCheck1"
                                >{% trans 'Copy all from quotation' %}</label>
                            </div>
                            <table
                                    id="datable-copy-quotation-product"
                                    class="table nowrap w-100 mb-5"
                                    hidden
                            >
                                <thead>
                                <tr class="bg-light">
                                    <th></th>
                                    <th>{% trans 'Product' %}</th>
                                    <th>{% trans 'Quantity' %}</th>
                                    <th>{% trans 'Input' %}</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                        <div class="modal-footer">
                            <button
                                    type="button" class="btn btn-secondary"
                                    data-bs-dismiss="modal"
                            >{% trans 'Close' %}</button>
                            <button
                                    type="button" class="btn btn-primary" id="btn-select-quotation-copy"
                            >{% trans 'Select' %}</button>
                            <button
                                    type="button" class="btn btn-primary" id="btn-quotation-copy-confirm"
                                    data-copy-type="copy-from" data-bs-dismiss="modal" hidden
                            >{% trans 'Copy' %}</button>
                            <input type="text" id="data-copy-quotation-detail" hidden>
                        </div>
                    </div>
                </div>
            </div>


            <div
                    class="modal fade" id="addQuickProduct" tabindex="-1" role="dialog"
                    aria-labelledby="addQuickProduct" aria-hidden="true" data-zone="quotation_products_data"
            >
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLongTitle">{% trans 'New product' %}</h5>
                            <button
                                    type="button"
                                    class="btn btn-icon btn-rounded btn-flush-light flush-soft-hover btn-lg"
                                    data-bs-dismiss="modal"
                            ><span class="icon"><i class="far fa-window-close"></i></span></button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label class="form-label required" for="add-product-title">{% trans 'Title' %}</label>
                                <input
                                        type="text" class="form-control"
                                        id="add-product-title"
                                        required
                                >
                            </div>
                            <div class="row">
                                <div class="col-12 col-md-8 col-lg-8">
                                    <div class="form-group">
                                        <label
                                                class="form-label required" for="add-product-code"
                                        >{% trans 'Code' %}</label>
                                        <input
                                                type="text" class="form-control"
                                                id="add-product-code"
                                                required
                                        >
                                    </div>
                                </div>
                                <div class="col-12 col-md-4 col-lg-4">
                                    <div class="mt-4" id="quick-product-choice">
                                        <div class="form-check form-check-inline d-flex align-items-center">
                                            <input
                                                    class="form-check-input" type="checkbox" id="inlineCheckbox2"
                                                    value="2"
                                            >
                                            <label
                                                    class="form-check-label" for="inlineCheckbox2"
                                            >{% trans 'For Purchase' %}</label>
                                        </div>
                                        <div class="form-check form-check-inline d-flex align-items-center">
                                            <input
                                                    class="form-check-input" type="checkbox" id="inlineCheckbox1"
                                                    value="1"
                                            >
                                            <label
                                                    class="form-check-label" for="inlineCheckbox1"
                                            >{% trans 'For Inventory' %}</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="add-product-remark">{% trans 'Description' %}</label>
                                <textarea class="form-control" id="add-product-remark" rows="2"></textarea>
                            </div>
                            <div class="form-group">
                                <label
                                        class="form-label" for="add-product-part-number"
                                >{% trans 'Part number' %}</label>
                                <input
                                        type="text" class="form-control"
                                        id="add-product-part-number"
                                        required
                                >
                            </div>
                            <div class="form-group">
                                <label class="form-label required" for="add-product-type">{% trans 'Type' %}</label>
                                <select
                                        class="form-select"
                                        id="add-product-type"
                                        data-url="{% url "ProductTypeListAPI" %}"
                                        data-method="GET"
                                        data-keyResp="product_type_list"
                                        multiple
                                ></select>
                            </div>
                            <div class="form-group">
                                <label
                                        class="form-label required" for="add-product-category"
                                >{% trans 'Category' %}</label>
                                <select
                                        class="form-select"
                                        id="add-product-category"
                                        data-url="{% url "ProductCategoryListAPI" %}"
                                        data-method="GET"
                                        data-keyResp="product_category_list"
                                ></select>
                            </div>
                            <div class="form-group">
                                <label
                                        class="form-label required" for="add-product-uom-group"
                                >{% trans 'UOM group' %}</label>
                                <select
                                        class="form-select"
                                        id="add-product-uom-group"
                                        data-url="{% url "UnitOfMeasureGroupListAPI" %}"
                                        data-method="GET"
                                        data-keyResp="unit_of_measure_group"
                                ></select>
                            </div>
                            <div class="form-group">
                                <label class="form-label required" for="add-product-uom">{% trans 'UOM' %}</label>
                                <select
                                        class="form-select"
                                        id="add-product-uom"
                                        data-url="{% url "UnitOfMeasureListAPI" %}"
                                        data-method="GET"
                                        data-keyResp="unit_of_measure"
                                ></select>
                            </div>
                            <div class="form-group">
                                <label class="form-label required" for="add-product-tax">{% trans 'Tax' %}</label>
                                <select
                                        class="form-select"
                                        id="add-product-tax"
                                        data-url="{% url "TaxListAPI" %}"
                                        data-method="GET"
                                        data-keyResp="tax_list"
                                ></select>
                            </div>
                            <div class="form-group">
                                <label
                                        class="form-label" for="add-product-method"
                                >{% trans 'Traceability method' %}</label>
                                <select
                                        class="form-select"
                                        id="add-product-method"
                                ></select>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-zone="quotation_products_data">{% trans 'Close' %}</button>
                            <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="btn-save-product" data-zone="quotation_products_data">{% trans 'Save' %}</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-area">
            <div
                    class="modal fade" id="selectProductModal" tabindex="-1"
                    role="dialog" aria-labelledby="selectProductModal"
            >
                <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title"><b>{% trans 'Select product' %}</b></h5>
                            <button
                                    type="button"
                                    class="btn btn-icon btn-rounded btn-flush-light flush-soft-hover btn-lg"
                                    data-bs-dismiss="modal"
                            ><span class="icon"><i class="far fa-window-close"></i></span></button>
                        </div>
                        <div class="modal-body">
                            <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#addQuickProduct" data-zone="quotation_products_data">
                                <span><span class="icon"><i class="fa-solid fa-plus"></i></span><span>{% trans 'New' %}</span></span>
                            </button>
                            <table
                                    id="table-select-product"
                                    class="table nowrap w-100 mb-5"
                            >
                                <thead>
                                <tr class="bg-light">
                                    <th class="w-35">{% trans 'Product' %}</th>
                                    <th class="w-30">{% trans 'Description' %}</th>
                                    <th class="w-10">{% trans 'UOM' %}</th>
                                    <th class="w-10">{% trans 'Status' %}</th>
                                    <th class="w-15">{% trans 'Note' %}</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-zone="quotation_products_data">{% trans 'Close' %}</button>
                            <button type="button" class="btn btn-primary" id="btn-save-select-product" data-bs-dismiss="modal" data-zone="quotation_products_data">{% trans 'Save' %}</button>
                        </div>
                    </div>
                </div>
            </div>

            <div
                    class="modal fade" id="selectPriceModal" tabindex="-1"
                    role="dialog" aria-labelledby="selectPriceModal"
            >
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title"><b>{% trans 'Select product price' %}</b></h5>
                            <button type="button" class="btn btn-icon btn-rounded btn-flush-light flush-soft-hover btn-lg" data-bs-dismiss="modal"><span class="icon"><i class="far fa-window-close"></i></span></button>
                        </div>
                        <div class="modal-body">
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-zone="quotation_products_data">{% trans 'Close' %}</button>
                            <button type="button" class="btn btn-primary" id="btn-save-select-price" data-bs-dismiss="modal" data-zone="quotation_products_data">{% trans 'Save' %}</button>
                        </div>
                    </div>
                </div>
            </div>

            <div
                    class="modal fade" id="selectCostModal" tabindex="-1"
                    role="dialog" aria-labelledby="selectCostModal"
            >
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title"><b>{% trans 'Select product cost' %}</b></h5>
                            <button type="button" class="btn btn-icon btn-rounded btn-flush-light flush-soft-hover btn-lg" data-bs-dismiss="modal"><span class="icon"><i class="far fa-window-close"></i></span></button>
                        </div>
                        <div class="modal-body">
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-zone="quotation_costs_data">{% trans 'Close' %}</button>
                            <button type="button" class="btn btn-primary" id="btn-save-select-cost" data-bs-dismiss="modal" data-zone="quotation_costs_data">{% trans 'Save' %}</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>

    {% include 'extends/import-datatable/modal-import-db.html' %}
    <table hidden data-table-id="datable-quotation-create-product-import-db" class="nowrap w-100 table mt-1">
        <thead class="sticky">
            <tr>
                <th>#</th>
                <th>{% trans 'Status' %}</th>
                <th>{% trans 'Product Code' %}</th>
                <th>{% trans 'Product Name' %}</th>
                <th>{% trans 'Description' %}</th>
                <th>{% trans 'Product category' %}</th>
                <th>{% trans 'Is service' %}</th>
                <th>{% trans 'UoM' %}</th>
                <th>{% trans 'Quantity' %}</th>
                <th>{% trans 'Unit Price' %}</th>
                <th>{% trans 'Discount' %} (%)</th>
                <th>{% trans 'Tax' %}</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
{% endblock %}

{% block dataHiddenGroup %}
    <input
        type="text"
        id="app-trans-factory"
        data-check-if-shipping-address="{% trans 'Please select shipping address' %}"
        data-select-address="{% trans 'Select this address' %}"
        data-view-detail-info="{% trans 'View detail' %}"
        data-btn-close="{% trans 'Close' %}"
        data-more-information="{% trans 'More information' %}"
        data-apply="{% trans 'Apply' %}"
        data-refreshed="{% trans 'Data is refreshed.' %}"
        data-valid="{% trans "Valid" %}"
        data-required-expense="{% trans "Expense is required" %}"
        data-required-product-uom="{% trans "Product unit of measure is required" %}"
        data-required-expense-uom="{% trans "Expense unit of measure is required" %}"
        data-copy-successfully="{% trans "Copy successfully" %}"
        data-validate-ss-role="{% trans "Opportunity is disabled because employee in short sales roles" %}"
        data-add-new="{% trans "Add new" %}"
        data-promotion="{% trans "Promotion" %}"
        data-shipping="{% trans "Shipping fee" %}"
        data-valid-price-uom="{% trans "Price is not valid for unit of measure" %}"
        data-supplied-purchase="{% trans "Purchasing" %}"
        data-supplied-make="{% trans "Making" %}"
        data-discount-bt="{% trans "Discount before tax" %}"
        data-discount-at="{% trans "Discount after tax" %}"
        data-discount-product="{% trans "Discount on product" %}"
        data-gift="{% trans "Gift" %}"
        data-available="{% trans "Available" %}"
        data-unavailable="{% trans "Unavailable" %}"
        data-product-note-1="{% trans "Selected" %}"
        data-product-note-2="{% trans "The product is in the design stage for another project" %}"
        data-product-note-3="{% trans "The product does not have opportunity BOM" %}"
        data-product-note-4="{% trans "The product is only used for project sale" %}"
        data-product-no-cost="{% trans "The product does not have warehouse cost list. You can choose bill of material cost, standard cost or input cost." %}"
        data-cost-bom="{% trans "Bill of material cost" %}"
        data-cost-standard="{% trans "Standard cost" %}"
        data-required-customer="{% trans "Customer is required" %}"
        data-required-contact="{% trans "Contact is required" %}"
        data-required-payment="{% trans "Payment is required" %}"
        data-required-product="{% trans "Product is required" %}"
        data-refresh="{% trans "Refresh" %}"
        data-add="{% trans "Add" %}"
        data-add-product="{% trans "Add Product" %}"
        data-add-group="{% trans "Add group" %}"
        data-add-expense="{% trans "Add Expense" %}"
        data-add-labor="{% trans "Add Labor" %}"
    >
    <input
            type="text"
            id="app-url-factory"
            data-url-quick-product="{% url 'ProductQuickCreateAPI' %}"
            data-md-product="{% url 'ProductForSaleListAPI' %}"
            data-md-product-detail="{% url 'ProductForSaleDetailAPI' 1 %}"
            data-md-bom="{% url 'BOMOrderListAPI' %}"
            data-md-uom="{% url "UnitOfMeasureListAPI" %}"
            data-md-tax="{% url "TaxListAPI" %}"
            data-md-labor="{% url "ExpenseListAPI" %}"
            data-md-expense="{% url "ExpenseItemListAPI" %}"
            data-md-promotion="{% url "ExpenseItemListAPI" %}"

            data-so-product-wo="{% url 'SOProductWOListAPI' %}"
    >

    <input
            type="text"
            id="data-init-quotation-create-request-employee"
            value="{{ data.employee_current }}"
    >
    <input
            type="text"
            id="data-init-quotation-create-company-currency-config"
    >
    <input
            type="text"
            id="data-quotation"
            value="[]"
    >
    <input
            type="text"
            id="data-init-quotation-create-promotion"
            data-url="{% url "PromotionCheckListAPI" %}"
            data-link-detail="{% url "PromotionDetail" 1 %}"
            data-method="GET"
    >
    <input
            type="text"
            id="data-init-quotation-create-shipping"
            data-url="{% url "ShippingCheckListAPI" %}"
            data-link-detail="{% url "ShippingDetail" 1 %}"
            data-method="GET"
    >
    <input
            type="text"
            id="data-init-copy-quotation"
            data-url="{% url "QuotationListAPI" %}"
            data-url-detail="{% url "QuotationDetailAPI" 1 %}"
            data-method="GET"
    >
    <input
            type="text"
            id="data-init-opportunity"
            value="{{ data.opportunity }}"
    >
    <input
            type="text"
            id="customer-price-list"
    >
    <input
            type="text"
            id="quotation-config-data"
            class="quotation-config"
            data-url="{% url "QuotationConfigDetailAPI" %}"
            data-method="GET"
    >
    <input
            type="text"
            id="quotation-check-promotion"
    >
    <input
            type="text"
            id="quotation-copy-discount-on-total"
    >
    <input
            type="text"
            id="data-init-customer"
            data-url="{% url "AccountForSaleListAPI" %}"
            data-method="GET"
    >
    {{ data.employee_current|json_script:'employee_current' }}
{% endblock %}

{% block jsFooter %}
    <!-- Select2 -->
    <script src="{% static 'vendors/select2/dist/js/select2.full.min.js' %}"></script>

    <!-- Daterangepicker JS -->

    <script src="{% static 'vendors/daterangepicker/daterangepicker.js' %}"></script>

    <script src="{% static 'assets/sales/quotation/js/quotation_common.js' %}"></script>
    <script src="{% static 'assets/sales/quotation/js/quotation_create.js' %}"></script>

    <script src="{% static 'assets/js/extends/the-documents/auto-init-with-parameters.js' %}"></script>

    <script src="{% static 'assets/js/xlsx-0.18.5.full.min.js' %}"></script>
    <script src="{% static 'assets/js/import-datatable.js' %}"></script>
    <script src="{% static 'assets/js/direct-btn-group.js' %}"></script>
{% endblock %}