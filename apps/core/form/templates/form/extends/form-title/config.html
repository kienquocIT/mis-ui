{% load i18n define_action %}

<div class="drawer-config d-none" id="form-title-config">
    <form>
        {% csrf_token %}
        <div class="form-group">
            <label for="form-title-title" class="form-label">{% trans 'Title' %}</label>
            <input type="text" id="form-title-title" class="form-control" name="title" />
        </div>
        <div class="form-group">
            <label for="form-title-remark" class="form-label">{% trans 'Remarks' %}</label>
            <textarea id="form-title-remark" class="form-control" rows="3" name="remark"></textarea>
        </div>

        <hr style="background-color: #2a3746"/>

        <div class="form-group">
            <label for="form-title-label-placement" class="form-label">
                {% trans 'Label Placement' %}
                <i
                        class="fa-solid fa-circle-info"
                        data-bs-toggle="tooltip"
                        title="{% trans 'Changes to this configuration will not be reflected in real-time until saved' %}"
                ></i>
            </label>
            <select
                    id="form-title-label-placement"
                    class="input-radio-select"
                    name="label_placement"
            >
                <option value="top">{% trans 'Top' %}</option>
                <option value="left">{% trans 'Left' %}</option>
                <option value="right">{% trans 'Right' %}</option>
            </select>
        </div>
        <div class="form-group">
            <label for="form-title-instruction-placement" class="form-label">
                {% trans 'Instruction Placement' %}
                <i
                        class="fa-solid fa-circle-info"
                        data-bs-toggle="tooltip"
                        title="{% trans 'Changes to this configuration will not be reflected in real-time until saved' %}"
                ></i>
            </label>
            <select
                    id="form-title-instruction-placement"
                    class="input-radio-select"
                    name="instruction_placement"
            >
                <option value="top">{% trans 'Top' %}</option>
                <option value="bottom">{% trans 'Bottom' %}</option>
            </select>
        </div>

        <hr style="background-color: #2a3746"/>

        <div class="form-group mb-3">
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="form-title-authentication-required" name="authentication_required">
                <label for="form-title-authentication-required" class="form-check-label">
                    {% trans 'Require user login before submitting data' %}
                </label>
            </div>
{#            <label for="form-title-authentication-required" class="form-check-label">#}
{#                {% trans 'Require user login before submitting data' %}#}
{#            </label>#}
{#            <select name="authentication_required" id="form-title-authentication-required" class="input-radio-select">#}
{#                <option value="">-</option>#}
{#                <option value="user">BFlow User</option>#}
{#                <option value="email">Email</option>#}
{#            </select>#}
            <ul style="list-style-type:circle">
                <li>
                    <small class="form-text text-muted">
                        {% trans 'When the value is off, the anonymous user can submit data.' %}
                    </small>
                </li>
                <li>
                    <small class="form-text text-muted">
                        {% trans 'When the value is turned on, only logged-in users can submit data.' %}
                    </small>
                </li>
            </ul>
        </div>
        <div class="form-group mb-3">
            <label for="form-title-authentication-type">{% trans 'Authentication type' %}</label>
            <select name="authentication_type" id="form-title-authentication-type" class="input-radio-select">
                <option value="system">{% trans "Company's members" %}</option>
                <option value="email">{% trans 'Email' %}</option>
            </select>
            <small class="form-text text-muted">
                <ul style="list-style: circle">
                    <li>{% trans "Company's members" %}: {% trans 'Must be logged in with system account before being manipulated' %}</li>
                    <li>{% trans 'Email' %}: {% trans 'Authenticate users via email account before being manipulated' %}</li>
                </ul>
            </small>
        </div>
        <div class="form-group mb-3">
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="form-title-submit-only-one" name="submit_only_one">
                <label for="form-title-submit-only-one" class="form-check-label">
                    {% trans 'Allows submitting data only one time per user' %}
                </label>
                <small class="form-text text-muted">
                    {% trans 'This feature is available when the require authentication option is on' %}
                </small>
            </div>
        </div>
        <div class="form-group mb-3">
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="form-title-edit-submitted" name="edit_submitted">
                <label for="form-title-edit-submitted" class="form-check-label">
                    {% trans 'Allows edit submitted data of user' %}
                </label>
                <small class="form-text text-muted">
                    {% trans 'This feature is available when the require authentication option is on' %}
                </small>
            </div>
        </div>

        <hr style="background-color: #2a3746"/>

        <div class="form-group">
            <p>{% trans 'The default setting is displayed in the report' %}</p>
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="form-title-referrer-name-default-show-1" name="display_referrer_name">
                <label for="form-title-referrer-name-default-show-1" class="form-check-label">
                    {% trans 'Display referrer name' %}
                </label>
            </div>
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="form-title-referrer-name-default-show-2" name="display_creator">
                <label for="form-title-referrer-name-default-show-2" class="form-check-label">
                    {% trans 'Display creator name' %}
                </label>
            </div>
            <ul style="list-style-type:circle">
                <li>
                    <small class="form-text text-muted">
                        {% trans "The default configuration for hiding/showing columns on the website's Entries page." %}
                    </small>
                </li>
                <li>
                    <small class="form-text text-muted">
                        {% trans 'These information columns will still be included in the Excel export.' %}
                    </small>
                </li>
            </ul>
        </div>
    </form>
</div>

<script>
    $(document).ready(function (){
        const frm$ = $('#form-title-config');
        const eleAuthRequired$ = frm$.find('[name="authentication_required"]');
        const eleSubmitOnlyOne$ = frm$.find('[name="submit_only_one"]');
        const eleEditSubmit$ = frm$.find('[name="edit_submitted"]');
        const eleAuthType$ = frm$.find('[name="authentication_type"]');

        eleAuthRequired$.on('change', function (){
            if ($(this).prop('checked') === false){
                eleSubmitOnlyOne$.prop('checked', false).trigger('change').closest('.form-group').slideUp();
                eleEditSubmit$.prop('checked', false).trigger('change').closest('.form-group').slideUp();
                eleAuthType$.closest('.form-group').slideUp();
            } else {
                eleSubmitOnlyOne$.closest('.form-group').slideDown();
                eleEditSubmit$.closest('.form-group').slideDown();
                eleAuthType$.closest('.form-group').slideDown();
            }
        })
        eleSubmitOnlyOne$.on('change', function(){
            if ($(this).prop('checked') === true){
                if (eleAuthRequired$.prop('checked') === false) $(this).prop('checked', false).trigger('change');
            }
        })
        eleEditSubmit$.on('change', function(){
            if ($(this).prop('checked') === true){
                if (eleAuthRequired$.prop('checked') === false) $(this).prop('checked', false).trigger('change');
            }
        })
    })
</script>
