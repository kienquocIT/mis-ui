{% load static i18n %}

<div class="modal fade" id="modal-search-inventory" tabindex="-1">
    <div class="modal-dialog" style="min-width: 90vw; overflow-y: auto;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">{% trans 'Search Inventory' %}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                {# select product content #}
                <div id="product-content">
                    <table id="table-product-list" class="table nowrap w-100 mb-5" data-url="{% url "ProductListAPI" %}"
                        data-method="GET">
                            <thead>
                            <tr>
                                <th class="w-10"></th>
                                <th class="w-20">{% trans "Code" %}</th>
                                <th class="w-25">{% trans "Name" %}</th>
                                <th class="w-15">{% trans "Product Category" %}</th>
                                <th class="w-20">{% trans "Stacking method" %}</th>
                                <th class="w-10">{% trans "Stock" %}</th>
                            </tr>
                        </thead>
                    </table>
                </div>


                {# select warehouse and item content #}
                <div id="warehouse-and-item-content">
                    <div class="alert alert-info mb-3">
                        <div class="d-flex align-items-center">
                            <i class="bi bi-info-circle fs-4 me-3"></i>
                            <div>
                                <strong>Selected Product:</strong>
                                <span id="selected-product-info"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row gx-3">
                        <div class="col-md-6">
                            <h6 class="fw-semibold mb-3">
                                <i class="bi bi-house me-2"></i>
                                {% trans 'Warehouse Location' %}
                            </h6>
                            <table data-url="{% url 'ProductWarehouseListForFixedAssetAPI' %}" id='table-warehouse-list' class="table no-wrap w-100 mb-5">
                                <thead class="table-light sticky-top">
                                    <tr>
                                        <th class="text-center"></th>
                                        <th>{% trans 'Code' %}</th>
                                        <th>{% trans 'Name' %}</th>
                                        <th>{% trans 'Quantity' %}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>

                        <!-- RIGHT COLUMN: Stock Items -->
                        <div class="col-md-6">
                            <!-- Placeholder when no warehouse selected -->
                            <div class="h-100" id="stock-placeholder">
                                <div class="d-flex align-items-center justify-content-center">
                                    <div class="text-center text-muted py-5">
                                        <i class="bi bi-arrow-left-circle fs-1 mb-3"></i>
                                        <p class="mb-0">Select a warehouse to view stock</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Stock Section - For Products WITH Serial Numbers -->
                            <div id="serial-number-section">
                                <h6 class="fw-semibold mb-3">
                                    <i class="bi bi-upc-scan me-2"></i>
                                    Select Serial Numbers
                                </h6>
                                <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                                    <table data-url="{% url 'ProductWarehouseListForFixedAssetAPI' %}" id="table-serial-item" class="table table-hover table-sm mb-0">
                                        <thead class="table-light sticky-top">
                                            <tr>
                                                <th class="text-center"></th>
                                                <th>Serial Number</th>
                                                <th>Mfg Date</th>
                                                <th class="text-end">Unit Price</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Stock Section - For Products WITH LOT Management -->
                            <div id="lot-selection-section">
                                <h6 class="fw-semibold mb-3">
                                    <i class="bi bi-boxes me-2"></i>
                                    Select LOT/Batch
                                </h6>
                                <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                                    <table data-url="{% url 'ProductWarehouseListForFixedAssetAPI' %}" id="table-lot-item" class="table table-hover table-sm mb-0">
                                        <thead class="table-light sticky-top">
                                            <tr>
                                                <th class="text-center w-10"></th>
                                                <th class="w-20">{% trans 'LOT Number' %}</th>
                                                <th class="w-20">{% trans 'Manufacture Date' %}</th>
                                                <th class="w-20 text-center">{% trans 'Available Qty' %}</th>
                                                <th class="text-end w-30">{% trans 'Unit Cost' %}</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="mt-3">
                                    <div class="alert alert-warning mb-0">
                                        <i class="bi bi-exclamation-triangle me-2"></i>
                                        <strong>Note:</strong> Only <strong>1 unit</strong> will be transferred from selected LOT.
                                    </div>
                                </div>
                            </div>

                            <!-- Stock Section - For Products WITHOUT Serial Numbers -->
                            <div id="quantity-input-section">
                                <h6 class="fw-semibold mb-3">
                                    <i class="bi bi-box me-2"></i>
                                    Stock Information
                                </h6>
                                <div class="card border-success">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label text-muted">Available in Warehouse:</label>
                                                    <p class="fs-4 fw-bold text-success mb-0" id="stock-available-quantity"></p>
                                                </div>
                                                <div class="mb-0">
                                                    <label class="form-label text-muted">Unit Cost:</label>
                                                    <span class="fs-5 fw-semibold text-dark mb-0 mask-money" id="stock-unit-cost"></span>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="alert alert-warning mb-0">
                                                    <i class="bi bi-exclamation-triangle me-2"></i>
                                                    <strong>Fixed Asset Registration:</strong>
                                                    <p class="mb-0 mt-2">Only <strong>1 unit</strong> will be transferred per asset registration.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans 'Cancel' %}</button>
                    <button type="button" class="btn btn-outline-secondary" id="btn-back-inventory-product">
                        <span>{% trans 'Back' %}</span>
                    </button>
                    <button type="button" class="btn btn-primary" id="btn-next-inventory-product">
                        <span>{% trans 'Next' %}</span>
                    </button>
                    <button type="button" class="btn btn-primary" id="btn-confirm-inventory-product">
                        <span>{% trans 'Confirm' %}</span>
                    </button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal-search-ap-invoice" tabindex="-1">
    <div class="modal-dialog" style="min-width: 90vw; overflow-y: auto;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">{% trans 'Search AP Invoice' %}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="ap-invoice-content">
                    <table id="table-ap-invoice-list" class="table nowrap w-100 mb-5" data-url="{% url 'APInvoiceListAPI' %}"
                        data-method="GET">
                            <thead>
                            <tr>
                                <th class="w-5"></th>
                                <th class="w-25">{% trans "Invoice" %}</th>
                                <th class="w-30">{% trans "Supplier" %}</th>
                                <th class="w-10">{% trans "Invoice Date" %}</th>
                                <th class="w-20">{% trans "Total Amount" %}</th>
                            </tr>
                        </thead>
                    </table>
                </div>

                <div id="ap-invoice-detail-content">
                    <div id="ap-invoice-item-list"></div>

                    <div class="card card-border mb-4 cost-summary-card" id="ap-invoice-item-summary">
                        <div class="card-body">
                            <div>
                                <span class="fs-5">Total Amount to Register:</span>
                                <span id="ap-invoice-total-summary" class="fw-bold text-primary h5 mb-0 mask-money"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans 'Cancel' %}</button>
                <button type="button" class="btn btn-outline-secondary" id="btn-back-ap-invoice">
                    <span>{% trans 'Back' %}</span>
                </button>
                <button type="button" class="btn btn-primary" id="btn-next-ap-invoice">
                    <span>{% trans 'Next' %}</span>
                </button>
                <button type="button" class="btn btn-primary" id="btn-confirm-ap-invoice">
                    <span>{% trans 'Confirm' %}</span>
                </button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal-search-cash-out" tabindex="-1">
    <div class="modal-dialog" style="min-width: 90vw; overflow-y: auto;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">{% trans 'Search Cash Out' %}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <table id="table-cash-out-list" class="table nowrap w-100 mb-5" data-url="{% url 'CashOutflowListAPI' %}"
                    data-method="GET">
                        <thead>
                        <tr>
                            <th class="w-5"></th>
                            <th class="w-25">{% trans "Invoice" %}</th>
                            <th class="w-30">{% trans "Supplier" %}</th>
                            <th class="w-10">{% trans "Invoice Date" %}</th>
                            <th class="w-20">{% trans "Total Amount" %}</th>
                        </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans 'Cancel' %}</button>
                <button type="button" class="btn btn-primary" id="btn-confirm-cash-out">
                    <span>{% trans 'Confirm' %}</span>
                </button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal-depreciation-preview" tabindex="-1">
    <div class="modal-dialog" style="min-width: 90vw; overflow-y: auto;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">{% trans 'Depreciation Review' %}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <table
                    id="table-depreciation-preview"
                    class="table nowrap w-100 mb-20"
                    style="min-width: 768px"
                >
                    <thead>
                        <tr class="bg-light">
                            <th>{% trans 'Month' %}</th>
                            <th>{% trans 'Begin date' %}</th>
                            <th>{% trans 'End date' %}</th>
                            <th>{% trans 'Begin net value' %}</th>
                            <th>{% trans 'Depreciation value' %}</th>
                            <th>{% trans 'End net value' %}</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans 'Close' %}</button>
            </div>
        </div>
    </div>
</div>
