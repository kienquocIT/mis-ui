{% extends 'base.html' %}
{% load static i18n %}
{% block title %}{% trans 'project page' %}{% endblock %}
{% block cssHeader %}
    <link rel="stylesheet" href="{% static 'vendors/frappe-gantt/dist/frappe-gantt.css' %}">
    <link rel="stylesheet" href="{% static 'assets/project/css/project.css' %}">
{% endblock %}

{% block pageAction %}
    <a href="#">
        <button class="btn btn-outline-primary ntt-drawer-toggle-link btn-create-todo"
                type="button"
                data-drawer-target="#drawer_task_create"
                data-drawer-active="false"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                data-bs-original-title="{% trans 'Create' %}">
        <span>
            <span>{% trans 'Create' %}</span>
            <span class="icon">
                <i class="fa-solid fa-plus"></i>
            </span>
        </span>
        </button>
    </a>
{% endblock %}

{% block pageContent %}
    <!-- test gantt view-->
    <button id="get_tasks">get task</button>
    <div class="gantt-wrap">
        <div class="gantt-block gantt-left">
        </div>
        <div class="gantt-block gantt-right">
            <svg id="gantt"></svg>
        </div>
    </div>
    <!-- end gantt view-->
{% endblock %}
{% block jsFooter %}

    <script src="{% static 'vendors/frappe-gantt/dist/frappe-gantt.js' %}"></script>
    <script src="{% static 'assets/project/js/frappe-gantt-custom.js' %}"></script>
    <script>
        $(document).ready(function(){
            const LEFT_TITLE = [
                {"code": 'title', "name": $.fn.gettext('Title'), width: 200},
                {"code": 'data_from', "name": $.fn.gettext('Date from'), width: 100},
                {"code": 'data_to', "name": $.fn.gettext('Date to'), width: 100},
                {"code": 'work_status', "name": $.fn.gettext('Work status'), width: 100},
            ]
            var new_gantt = new Gantt(
                "#gantt",
                [
                    {
                        id: "11",
                        name: "Khảo sát thị trường",
                        start: "2023-07-16",
                        end: "2023-07-22",
                        progress: 0,
                        is_group: true,
                        is_toggle: true,
                        objData: {
                            id: "11",
                            title: "Khảo sát thị trường",
                            data_from: "2023-07-16",
                            data_to: "2023-07-22",
                            work_status: '',
                        }
                    },
                    {
                        id: "1",
                        name: "Draft the new contract document for sales team",
                        start: "2023-07-16",
                        end: "2023-07-20",
                        progress: 55,
                        child_of_group: true,
                        child_group_id: "11",
                        is_show: true,
                        objData: {
                            relation_style: null,
                            id: "1",
                            title: "Draft the new contract document for sales team",
                            data_from: "2023-07-16",
                            data_to: "2023-07-20",
                            work_status: 'to do',
                        }
                    },
                    {
                        id: "2",
                        name: "Find out the old contract documents",
                        start: "2023-07-19",
                        end: "2023-07-21",
                        progress: 85,
                        dependencies: "1",
                        child_of_group: true,
                        child_group_id: "11",
                        is_show: true,
                        objData: {
                            relation_style: 'SS',
                            id: "2",
                            title: "Find out the old contract documents",
                            data_from: "2023-07-19",
                            data_to: "2023-07-21",
                            work_status: 'pedding',
                            dependencies: "1",
                        }
                    },
                    {
                        id: "3",
                        name: "Organize meeting with sales associates to understand need in detail",
                        start: "2023-07-22",
                        end: "2023-07-23",
                        progress: 80,
                        dependencies: "2",
                        child_of_group: true,
                        child_group_id: "11",
                        is_show: true,
                        objData: {
                            relation_style: 'FS',
                            id: "3",
                            title: "Organize meeting with sales associates to understand need in detail",
                            data_from: "2023-07-21",
                            data_to: "2023-07-22",
                            work_status: 'in progress',
                            dependencies: "2",
                        }
                    },
                    {
                        id: "4",
                        name: "iOS App home page",
                        start: "2023-07-15",
                        end: "2023-07-17",
                        progress: 80,
                        objData: {
                            relation_style: null,
                            id: "4",
                            title: "iOS App home page",
                            data_from: "2023-07-15",
                            data_to: "2023-07-17",
                            work_status: 'completed'
                        }
                    },
                    {
                        id: "5",
                        name: "Write a release note",
                        start: "2023-07-18",
                        end: "2023-07-22",
                        progress: 65,
                        dependencies: "4",
                        objData: {
                            id: "5",
                            title: "Write a release note",
                            data_from: "2023-07-18",
                            data_to: "2023-07-22",
                            work_status: 'inital',
                            dependencies: "4"
                        }
                    },
                    {
                        id: "6",
                        name: "Write a release note l2",
                        start: "2023-07-18",
                        end: "2023-07-22",
                        progress: 55,
                        dependencies: "5",
                        objData: {
                            id: "6",
                            title: "Write a release note 2",
                            data_from: "2023-07-18",
                            data_to: "2023-07-22",
                            work_status: 'inital',
                            dependencies: "5"
                        }
                    }
                ],
                {
                    view_modes: ["Quarter Day", "Half Day", "Day", "Week", "Month", "Year"],
                    bar_height: 20,
                    padding: 18,
                    view_mode: "Week",
                    custom_popup_html: null,
                    left_list: LEFT_TITLE,
                    disable_on_click: true,
                    call_left_render: fGanttCustom.setup_left_content
                }
            );
            $('#get_tasks').on('click', function (){
                let getTasks = new_gantt.tasks
                console.log('new_gantt', getTasks)
            })
        });
    </script>
{% endblock %}
