{% load i18n %}
<div class="form-group text-center">
    <h4 id="header-title" class="text-primary" style="font-weight: bolder"></h4>
</div>
<div class="row text-right">
    <div class="col-6 text-left">
        <button
                type="button" class="btn btn-xs btn-primary ml-1"
                id="btn-auto-update-stage"
        >
            <i class="fa-solid fa-arrow-rotate-right"></i>
            {% trans "Auto Update Stage" %}
        </button>
    </div>
    <div class="col-6 text-right">
        <a href="#"><i class="bi bi-bar-chart-line-fill"></i></a>
    </div>
</div>
<!-- Status -->
<div
        class="ml-1 d-flex" id="div-stage" data-method="GET"
        data-url="{% url "OpportunityConfigStageListAPI" %}"
>
</div>
<div id="stage-hidden" class="hidden">
    <div
            class="border rounded mt-1 pr-2 sub-stage w-100 text-center d-flex justify-content-center"
            style="flex-direction: column;"
    >
        <p class="stage-indicator" style="margin-bottom: auto;"></p>
        <div class="dropdown dropup" style="margin-top: auto;">
            <a href="#" data-bs-toggle="dropdown">
                                        <span class="text-right">
                                            <i class="bi bi-chevron-bar-right"></i>
                                        </span>
            </a>
            <div class="dropdown-menu position-absolute" style="z-index: 999;">
                <a
                        class="dropdown-item btn-go-to-stage"
                        href="#"
                >{% trans "Go to Stage" %}</a>
            </div>
        </div>
    </div>
</div>
<div class="mt-3 row">
    <div class="col-7 mb-2">
        <div class="row div-action">
            <div class="col-3">
                <span class="text-primary">{% trans 'Current action' %}</span>
            </div>
            <div class="col-9 d-flex">
                <div class="btn-group dropdown">
                    <button
                            type="button" class="btn btn-primary btn-xs dropdown-toggle"
                            data-bs-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false"
                    >{% trans 'New Log' %}</button>
                    <div class="dropdown-menu dropdown-bordered">
                        <a
                                data-bs-toggle="modal" data-bs-target="#create-new-call-log"
                                class="dropdown-item create-new-call-log-button" href="#"
                        >
                            <i class="dropdown-icon bi bi-telephone-fill text-primary"></i>
                            <span class="text-primary">{% trans 'New Call Log' %}</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a
                                data-bs-toggle="modal" data-bs-target="#send-email"
                                class="dropdown-item send-email-button" href="#"
                        >
                            <i class="dropdown-icon bi bi-envelope-fill text-primary"></i>
                            <span class="text-primary">{% trans 'Send Email' %}</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a
                                data-bs-toggle="modal" data-bs-target="#create-meeting"
                                class="dropdown-item new-meeting-button" href="#"
                        >
                            <i class="dropdown-icon bi bi-person-workspace text-primary"></i>
                            <span class="text-primary">{% trans 'New Meeting' %}</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a
                                data-drawer-target="#drawer_task_create"
                                data-drawer-active="false"
                                class="dropdown-item ntt-drawer-toggle-link current-create-task"
                                href="#"
                        >
                            <i class="dropdown-icon fa-solid fa-list-check text-primary"></i>
                            <span class="text-primary">{% trans 'New Task' %}</span>
                        </a>
                    </div>
                </div>
                <div class="dropdown">
                    <button
                            type="button" class="btn btn-primary btn-xs ml-2"
                            data-bs-toggle="dropdown"
                    ><i
                            class="fa-solid fa-arrows-spin"
                    ></i> {% trans 'Create Related Feature' %}
                    </button>
                    <div class="dropdown-menu">
                        <a
                                class="dropdown-item btn-create-related-feature"
                                data-url="{% url 'QuotationCreate' %}"
                                href="#"
                        >{% trans 'Quotation' %}</a>
                        <a
                                class="dropdown-item btn-create-related-feature"
                                data-url="{% url 'SaleOrderCreate' %}"
                                href="#"
                        >{% trans 'Sale Order' %}</a>
                        <a
                                class="dropdown-item btn-create-related-feature"
                                data-url="{% url 'AdvancePaymentCreate' %}"
                                href="#"
                        >{% trans 'Advance Payment' %}</a>
                        <a
                                class="dropdown-item btn-create-related-feature"
                                data-url="{% url 'PaymentCreate' %}"
                                href="#"
                        >{% trans 'Payment' %}</a>
                        <a
                                class="dropdown-item btn-create-related-feature"
                                data-url="{% url 'ReturnAdvanceCreate' %}"
                                href="#"
                        >{% trans 'Return advance' %}</a>
                    </div>
                </div>

                <div class="dropdown">
                    <button
                            type="button" class="btn btn-primary ml-2 btn-xs"
                            data-bs-toggle="dropdown"
                    ><i
                            class="bi bi-box-arrow-up-right"
                    ></i> {% trans 'View Related Feature' %}
                    </button>
                    <div class="dropdown-menu">
                        <a
                                class="dropdown-item item-detail-related-feature"
                                id="item-related-quotation" href="#"
                                target="_blank"
                        >{% trans 'Quotation' %}</a>
                        <a
                                class="dropdown-item item-detail-related-feature"
                                id="item-related-sale-order" href="#"
                                target="_blank"
                        >{% trans 'Sale Order' %}</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row div-activity hidden">
            <div class="col-3">
                <span class="text-primary">{% trans "Activity logs" %}</span>
            </div>
            <div class="col-9">
                <div class="btn-group dropdown">
                    <button
                            type="button" class="btn btn-primary btn-xs dropdown-toggle"
                            data-bs-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false"
                    >{% trans 'New Log' %}</button>
                    <div class="dropdown-menu dropdown-bordered">
                        <a
                                data-bs-toggle="modal" data-bs-target="#create-new-call-log"
                                class="dropdown-item create-new-call-log-button" href="#"
                        >
                            <i class="dropdown-icon bi bi-telephone-fill text-primary"></i>
                            <span class="text-primary">{% trans 'New Call Log' %}</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a
                                data-bs-toggle="modal" data-bs-target="#send-email"
                                class="dropdown-item send-email-button" href="#"
                        >
                            <i class="dropdown-icon bi bi-envelope-fill text-primary"></i>
                            <span class="text-primary">{% trans 'Send Email' %}</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a
                                data-bs-toggle="modal" data-bs-target="#create-meeting"
                                class="dropdown-item new-meeting-button" href="#"
                        >
                            <i class="dropdown-icon bi bi-person-workspace text-primary"></i>
                            <span class="text-primary">{% trans 'New Meeting' %}</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a
                                data-drawer-target="#drawer_task_create"
                                data-drawer-active="false"
                                class="dropdown-item ntt-drawer-toggle-link current-create-task"
                                href="#"
                        >
                            <i class="dropdown-icon fa-solid fa-list-check text-primary"></i>
                            <span class="text-primary">{% trans 'New Task' %}</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-5 text-right">
        <a href="#" id="btn-show-action">
                                <span
                                        class="ml-2"
                                        data-bs-toggle="tooltip"
                                        data-bs-placement="top"
                                        data-bs-original-title="{% trans 'Show actions' %}"
                                >
                                    <i class="bi bi-pip text-primary"></i>
                                </span>
        </a>
        <a href="#" id="btn-show-activity">
                                <span
                                        class="ml-2"
                                        data-bs-toggle="tooltip"
                                        data-bs-placement="top"
                                        data-bs-original-title="{% trans 'Show activity logs' %}"
                                >
                                    <i class="bi bi-clock-history text-primary"></i>
                                </span>
        </a>
    </div>
    <div class="mt-2 w-100 div-action">
        <div class="row">
            <div class="bg-light ml-2 h-150p">
                <div class="bg-blue-light-4 mt-1 mb-1 h-90">
                    <div class="row">
                        <div class="col-10">
                            <span class="text-black ml-1">{% trans "Document For Customer" %}</span>
                        </div>
                        <div class="col-2 text-right mt-2">
                            <a
                                    href="" data-url="{% url "OpportunityDocumentCreate" %}"
                                    target="_blank"
                                    class="mr-2 btn-add-document"
                            >
                                <span class="badge badge-primary w-50">{% trans 'Do' %}</span>
                            </a>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-10">
                        </div>
                        <div class="col-2 text-right">
                            <a href="#" class="mr-2">
                                <span class="badge badge-orange w-50">{% trans 'Skip' %}</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-2">
            <span class="text-primary">{% trans 'Next Action' %}</span>
        </div>
        <div class="row mt-2">
            <div class="ml-2">
                <div class="row">
                    <div class="col-6 bg-light h-150p pr-2 pl-4">
                        <div class="bg-green-light-4 mt-1 mb-1 h-90 row">
                            <div class="col-10">
                                <p class="text-black">Meetting with customer</p>
                            </div>
                            <div class="col-2 text-right mt-2">
                                <a href="#">
                                    <span class="badge badge-grey w-50">{% trans 'Do' %}</span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-6 bg-light h-150p pl-3">
                        <div class="bg-green-light-4 mt-1 mb-1 h-90">
                            <div class="row">
                                <div class="col-10">
                                    <span class="text-black ml-1">Create Quotation and send customer</span>
                                </div>
                                <div class="col-2 text-right mt-2">
                                    <a href="#" class="mr-2">
                                        <span class="badge badge-grey w-50">{% trans 'Do' %}</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="mt-2 mb-5 w-100 hidden div-activity bg-gray-light-5 border-2 border rounded shadow-primary">
        <div class="row mt-2 mb-2">
            <div class="col-12">
                <table class="table nowrap w-100" id="table-timeline"
                       data-url-logs_list="{% url 'OpportunityActivityLogListAPI' %}"
                       data-url-delete-call-log="{% url 'OpportunityCallLogDeleteAPI' '0' %}"
                       data-url-delete-email="{% url 'OpportunityEmailDeleteAPI' '0' %}"
                       data-url-delete-meeting="{% url 'OpportunityMeetingDeleteAPI' '0' %}"
                       data-method="GET">
                    <thead>
                    <tr>
                        <th>{% trans "Activity" %}</th>
                        <th class="text-center">{% trans "Type" %}</th>
                        <th>{% trans 'Subject' %}
                            <i class="fas fa-info-circle icon-info"
                               data-bs-toggle="tooltip"
                               data-bs-placement="bottom"
                               title="{% trans 'Press row here to see detail.' %}">
                            </i>
                        </th>
                        <th>{% trans "Date" %}</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="row mt-2">
        <ul class="nav nav-light nav-tabs col-9" id="tab-select">
            <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="tab" href="#tab_product">
                    <span class="nav-link-text">{% trans 'Product' %}</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#tab_competitors">
                    <span class="nav-link-text">{% trans 'Competitors' %}</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#tab_contact_role">
                    <span class="nav-link-text">{% trans 'Contact Role' %}</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#tab_account_history">
                    <span class="nav-link-text">{% trans 'Account History' %}</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#tab_team">
                    <span class="nav-link-text">{% trans 'Team' %}</span>
                </a>
            </li>
        </ul>
        <div class="col-3 d-flex justify-content-end">
            <div class="form-check mt-3">
                <input type="checkbox" class="form-check-input" id="check-lost-reason">
                <label
                        class="form-check-label"
                        for="check-lost-reason"
                >{% trans "Lost by other reason" %}</label>
            </div>
        </div>
        <div class="tab-content mx-4">
            <div class="tab-pane fade show active mb-25" id="tab_product">
                <div class="row">
                    <div class="col-12">
                        <div class="table-responsive">
                            <table class="table w-100 nowrap" id="table-products">
                                <thead>
                                <tr>
                                    <th class="">#</th>
                                    <th>{% trans "Product" %}</th>
                                    <th>{% trans 'Product Category' %}</th>
                                    <th>{% trans 'UoM' %}</th>
                                    <th>{% trans "Quantity" %}</th>
                                    <th>{% trans "Unit Price" %}</th>
                                    <th>{% trans "Tax" %}</th>
                                    <th>{% trans "Subtotal Price" %}</th>
                                    <th></th>
                                </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-5 dropdown">
                        <button
                                type="button" data-bs-toggle="dropdown"
                                class="btn btn-link btn-animated"
                        >
                                                    <span>
                                                        <span class="icon">
                                                            <span class="feather-icon">
                                                                <i data-feather="plus"></i>
                                                            </span>
                                                        </span>
                                                        <span>{% trans 'Add Product' %}</span>
                                                    </span>
                        </button>
                        <div class="dropdown-menu">
                            <a
                                    class="dropdown-item" href="#"
                                    id="btn-add-select-product"
                            >{% trans 'Select Product' %}</a>
                            <a
                                    class="dropdown-item" href="#"
                                    id="btn-add-input-product"
                            >{% trans 'Input Product' %}</a>
                        </div>
                    </div>
                    <div class="col-7 mt-5">
                        <div class="row mb-2">
                            <div class="col-6"><p>{% trans 'Pretax Amount' %}</p></div>
                            <div class="col-6 readonly">
                                <input
                                        id="input-product-pretax-amount"
                                        type="text"
                                        class="form-control mask-money"
                                        data-return-type="number"
                                        readonly
                                >
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="col-6"><p>{% trans 'Taxes' %}</p></div>
                            <div class="col-6 readonly">
                                <input
                                        id="input-product-taxes"
                                        type="text"
                                        class="form-control mask-money"
                                        data-return-type="number"
                                        readonly
                                >
                            </div>
                        </div>
                        <hr>
                        <div class="row mb-2">
                            <div class="col-6"><b>{% trans 'Total' %}</b></div>
                            <div class="col-6 readonly">
                                <input
                                        id="input-product-total"
                                        type="text"
                                        class="form-control mask-money"
                                        data-return-type="number"
                                        readonly
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade mb-25" id="tab_competitors">
                <button type="button" class="btn btn-link btn-animated" id="btn-add-competitor">
                                            <span>
                                                <span class="icon">
                                                    <span class="feather-icon">
                                                        <i data-feather="plus"></i>
                                                    </span>
                                                </span>
                                                <span>{% trans 'Add Competitor' %}</span>
                                            </span>
                </button>
                <table class="table nowrap w-100" id="table-competitors">
                    <thead>
                    <tr>
                        <th class="wrap-text w-30">{% trans "Name" %}</th>
                        <th class="wrap-text w-30">{% trans 'Strength' %}</th>
                        <th class="wrap-text w-30">{% trans 'Weakness' %}</th>
                        <th class="wrap-text w-10">{% trans "Win deal" %}</th>
                        <th></th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="tab-pane fade mb-25" id="tab_contact_role">
                <button type="button" class="btn btn-link btn-animated" id="btn-add-contact">
                                <span>
                                    <span class="icon">
                                        <span class="feather-icon">
                                            <i data-feather="plus"></i>
                                        </span>
                                    </span>
                                    <span>{% trans 'Add Contact' %}</span>
                                </span>
                </button>
                <table class="table nowrap w-100" id="table-contact-role">
                    <thead>
                    <tr>
                        <th>{% trans "Which Customer" %}</th>
                        <th>{% trans 'Name' %}</th>
                        <th>{% trans 'Job title' %}</th>
                        <th>{% trans "Role" %}</th>
                        <th></th>
                    </tr>
                    </thead>
                </table>
                <div class="form-group">
                    <label class="form-label" for="box-select-factor">{% trans "Select Reason why customer buy your product" %}</label>
                    <select
                            class="form-select"
                            multiple
                            id="box-select-factor"
                            data-method="GET"
                            data-url="{% url 'OpportunityCustomerDecisionFactorListAPI' %}"
                            data-keyResp="opportunity_decision_factor"
                    ></select>
                </div>
            </div>
            <div class="tab-pane fade mb-25" id="tab_account_history">
                <div class="d-flex overflow-auto">

                </div>
            </div>
            <div class="tab-pane fade mb-25" id="tab_team">
                <div class="row mb-3">
                    <div class="col-12 shadow shadow-bottom shadow-left border rounded p-5">
                        <div class="row" id="member-item-list">
                            <div class="member-item col-12 col-lg-4 col-md-6">
                                <div
                                        class="card"
                                        data-id="new"
                                >
                                    <button
                                            type="button" class="btn btn-link btn-animated"
                                            data-bs-toggle="modal"
                                            data-bs-target="#modalAddMember"
                                            id="btn-show-modal-add-member"
                                    >
                                <span>
                                    <span class="icon">
                                        <span class="feather-icon">
                                            <i data-feather="plus"></i>
                                        </span>
                                    </span>
                                    <span>{% trans 'Add Member' %}</span>
                                </span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-3">
                    <div
                            class="col-12 shadow shadow-bottom shadow-left border rounded p-5 hidden"
                            id="box-edit-permit"
                            data-url="{% url 'MemberOfOpportunityDetail' pk_opp=pk pk_member='__pk_member__' %}"
                            data-id=""
                    >
                        <div class="row mb-2">
                            <div class="col-12 col-md-6 col-lg-6 col-xl-6 mb-1">
                                <div class="form-group">
                                    <label for="member-current-edit" class="form-label">{% trans 'Member' %}</label>
                                    <select name="" id="member-current-edit" class="form-select">
                                        <option value="" selected></option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-12 col-md-6 col-lg-6 col-xl-6 mb-1">
                                <div class="form-group">
                                    <div class="form-label">{% trans 'Actions' %}</div>
                                    <button
                                            class="btn btn-primary text-white form-control" type="button"
                                            id="btnSavePermitMember"
                                    >{% trans 'Save' %}</button>
                                </div>
                            </div>
                            <div class="col-12 mb-1">
                                <div class="row">
                                    <div class="col-12 col-md-6 col-lg-6 col-xl-3 mb-1">
                                        <div class="form-check form-switch">
                                            <input type="checkbox" class="form-check-input" id="enable-view-opp-member">
                                            <label class="form-check-label" for="enable-view-opp-member">
                                                {% trans 'Allow view member' %}
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-6 col-xl-3 mb-1">
                                        <div class="form-check form-switch">
                                            <input type="checkbox" class="form-check-input" id="enable-add-opp-member">
                                            <label class="form-check-label" for="enable-add-opp-member">
                                                {% trans 'Allow add member' %}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="separator separator-light m-0"></div>
                        </div>
                        <div class="row mb-2">
                            {% include 'core/hr/extends/permission_group_tabs.html' with plan_app_enabled=True permit_enabled=True actions_enabled=True add_new_enabled="true" warning_enabled="true" extend_action="sales/opportunity/extends/ext_actions.html" %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>