{% extends 'base.html' %}
{% load static i18n %}
{% block title %}
    {% trans 'Asset, Tools delivery' %} {% trans 'update' %}
{% endblock %}
{% block cssHeader %}
    <link href="{% static 'vendors/daterangepicker/daterangepicker.css' %}" rel="stylesheet" type="text/css"/>
    <style>
    .min-w_768p{
        min-width: 768px;
    }
    .pointer{cursor: pointer}
    .title_prod p > span {
        color: rgb(90, 147, 255)
    }
    </style>
{% endblock %}
{% block pageAction %}
    <button class="btn btn-outline-primary" type="submit" form="asset_delivery_form">
            <span>
                <span>{% trans 'Save' %}</span>
                <span class="icon">
                    <i class="fa-regular fa-floppy-disk"></i>
                </span>
            </span>
    </button>
{% endblock %}

{% block pageContent %}
    <!-- from create-->
    <form class="container-fluid mt-4" id="asset_delivery_form" method="post" data-method="PUT" autocomplete="off"
          data-url-redirect="{% url 'AssetToolsDeliveryList' %}"
          data-url="{% url 'AssetToolsDeliveryEditAPI' data.pk %}">
        {% csrf_token %}
        <div class="row">
            <div class="col-xs-12 col-md-6 form-group">
                <label for="titleInput" class="form-label required">{% trans 'Title' %}</label>
                <input type="text" name="title" id="titleInput" class="form-control" required>
            </div>
            <div class="col-xs-12 col-md-6 form-group">
                <label for="dateCreatedInput" class="form-label">{% trans 'Date' %}</label>
                <div class="input-affix-wrapper">
                    <input type="text" id="dateCreatedInput" name="date_created" class="form-control date-picker"
                           autocomplete="off">
                    <span class="input-suffix"><i class="fa-solid fa-calendar-days"></i></span>
                </div>
            </div>
            <div class="col-xs-12 col-md-6 form-group">
                <label for="selectProvide" class="form-label required">{% trans 'Request' %}</label>
                <select class="form-select" name="provide" id="selectProvide"
                        data-url="{% url 'AssetToolsProvideRequestListAPI' %}"
                        data-keyResp="asset_provide_list" data-keyText="code" data-keyId="id"
                        data-params="{'complete_delivered': false, 'system_status__gte':2}"
                >
                </select>
            </div>
            <div class="col-xs-12 col-md-6 form-group">
                <label for="SystemStatusInput" class="form-label">{% trans 'Status' %}</label>
                <input type="text" name="system_status" id="SystemStatusInput" class="form-control" disabled>
            </div>
            <div class="col-xs-12 col-md-6 form-group">
                <label for="inputEmployeeInheritor" class="form-label required">{% trans 'Beneficiary' %}</label>
                <input type="text" name="provide_inheritor" class="form-control" readonly id="inputEmployeeInheritor">
            </div>
            <div class="col-xs-12 col-md-6 form-group">
                <label for="remarkInput" class="form-label">{% trans 'Note' %}</label>
                <textarea name="remark" id="remarkInput" class="form-control" rows="3"></textarea>
            </div>
        </div>
        <div class="row mt-2">
            <div class="col-md-12 col-xs-12">
                <ul class="nav nav-line nav-light nav-tabs">
                    <li class="nav-item">
                        <a href="#delivery" class="nav-link active" data-bs-toggle="tab">
                            <span class="nav-link-text">{% trans 'Delivery' %}</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#attachment" class="nav-link" data-bs-toggle="tab">
                        <span class="nav-link-text">
                            {% trans 'Attachment' %}
                        </span>
                        </a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="delivery">
                        <table id="products_detail_tbl" class="table nowrap w-100 mb-5 min-w-1500p">
                                <thead>
                                <tr>
                                    <th>{% trans 'Product' %}</th>
                                    <th>{% trans 'Request' %}</th>
                                    <th>{% trans 'Provided' %}</th>
                                    <th><span class="required">{% trans 'Done' %}</span></th>
                                    <th><span class="required">{% trans 'Date' %}</span></th>
                                    <th></th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        <div class="clearfix">
                            <button class="btn btn-outline-primary disabled" type="button" id="add_new_line"
                            data-bs-toggle="modal" data-bs-target="#provide_product_list">
                                <span>
                                    <span>{% trans 'Edit items' %}</span>
                                    <span class="icon">
                                        <i class="fa-regular fa-plus"></i>
                                    </span>
                                </span>
                            </button>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="attachment">
                        {% include 'extends/files/all.html' %}
                    </div>
                </div>
            </div>
        </div>
    </form>
    <!-- modal provide product list -->
    {% include 'eoffice/assettools/delivery/modal_provide_product.html' %}
{% endblock %}
{% block dataHiddenGroup %}
    {{ data.system_status|json_script:'sys_stt' }}
    <div class="delete_btn">
        <a class="btn btn-icon btn-flush-dark btn-rounded flush-soft-hover btn-remove-row">
            <span class="btn-icon-wrap">
                <i class="fa-solid fa-trash-can"></i>
            </span>
        </a>
    </div>
    <input type="text" id="url-factory"
           data-provide_detail-url="{% url 'AssetProductListByProvideIDAPI'%}"
           data-prod-detail="{% url 'InstrumentToolDetail' 1%}"
           data-detail-url="{% url 'AssetToolsDeliveryDetailAPI' data.pk %}"
           data-fixed-detail="{% url 'FixedAssetDetail' 1%}"
    >
    <input type="text" id="trans-factory" data-products="{% trans 'List of Asset, Tools request is empty' %}"
    data-return="{% trans 'Detail' %}"
    data-avail="{% trans 'Available' %}"
    data-uom="{% trans 'UOM' %}"
    data-err-done="{% trans 'Done number is not valid value' %}"
    data-out_of_stock="{% trans 'Out of stock' %}">
{% endblock %}
{% block jsFooter %}
    <script src="{% static 'vendors/daterangepicker/daterangepicker.js' %}"></script>
    <script src="{% static 'assets/js/extends/components/custom-handle-bs-dropdown.js' %}"></script>
    <script src="{% static 'assets/js/eoffice/assettools/delivery/asset_delivery_common.js' %}"></script>
    <script src="{% static 'assets/js/eoffice/assettools/delivery/edit.js' %}"></script>
{% endblock %}
